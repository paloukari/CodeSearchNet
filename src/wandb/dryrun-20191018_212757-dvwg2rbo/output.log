2019-10-18 21:27:58.653070: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-18 21:27:58.819479: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-10-18 21:27:58.820428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:00:07.0
totalMemory: 15.75GiB freeMemory: 15.44GiB
2019-10-18 21:27:58.820460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-10-18 21:27:59.336136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-10-18 21:27:59.336195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-10-18 21:27:59.336205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-10-18 21:27:59.336335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14943 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:00:07.0, compute capability: 7.0)
Tokenizing and building vocabulary for code snippets and queries.  This step may take several hours.
Starting training run convselfatt-2019-10-18-21-27-57 of model ConvSelfAttentionModel with following hypers:
{'code_token_vocab_size': 10000, 'code_token_vocab_count_threshold': 10, 'code_token_embedding_size': 128, 'code_use_subtokens': False, 'code_mark_subtoken_end': False, 'code_max_num_tokens': 200, 'code_use_bpe': True, 'code_pct_bpe': 0.5, 'code_1dcnn_position_encoding': 'none', 'code_1dcnn_layer_list': [128, 128], 'code_1dcnn_kernel_width': [8, 8], 'code_1dcnn_add_residual_connections': True, 'code_1dcnn_activation': 'tanh', 'code_self_attention_activation': 'gelu', 'code_self_attention_hidden_size': 128, 'code_self_attention_intermediate_size': 512, 'code_self_attention_num_layers': 2, 'code_self_attention_num_heads': 8, 'code_self_attention_pool_mode': 'weighted_mean', 'query_token_vocab_size': 10000, 'query_token_vocab_count_threshold': 10, 'query_token_embedding_size': 128, 'query_use_subtokens': False, 'query_mark_subtoken_end': False, 'query_max_num_tokens': 30, 'query_use_bpe': True, 'query_pct_bpe': 0.5, 'query_1dcnn_position_encoding': 'none', 'query_1dcnn_layer_list': [128, 128], 'query_1dcnn_kernel_width': [8, 8], 'query_1dcnn_add_residual_connections': True, 'query_1dcnn_activation': 'tanh', 'query_self_attention_activation': 'gelu', 'query_self_attention_hidden_size': 128, 'query_self_attention_intermediate_size': 512, 'query_self_attention_num_layers': 2, 'query_self_attention_num_heads': 8, 'query_self_attention_pool_mode': 'weighted_mean', 'batch_size': 650, 'optimizer': 'Adam', 'seed': 0, 'dropout_keep_rate': 0.9, 'learning_rate': 0.0005, 'learning_rate_code_scale_factor': 1.0, 'learning_rate_query_scale_factor': 1.0, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip': 1, 'loss': 'softmax', 'margin': 1, 'max_epochs': 2, 'patience': 5, 'fraction_using_func_name': 0.1, 'min_len_func_name_for_query': 12, 'query_random_token_frequency': 0.0}
Loading training and validation data.
Begin Training.
Training on 30000 python samples.
Validating on 23107 python samples.
==== Epoch 0 ====
0 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 0 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.7220.  MRR so far: 0.0097 0 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.9478.  MRR so far: 0.0114 0 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.9394.  MRR so far: 0.0116 0 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.8694.  MRR so far: 0.0114 0 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.8111.  MRR so far: 0.0115 0 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.7646.  MRR so far: 0.0118 0 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.7247.  MRR so far: 0.0126 0 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.6937.  MRR so far: 0.0128 0 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.6656.  MRR so far: 0.0135 0 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.6444.  MRR so far: 0.0141 0 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.6243.  MRR so far: 0.0149 0 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.6060.  MRR so far: 0.0155 0 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.5901.  MRR so far: 0.0162 0 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.5751.  MRR so far: 0.0164 0 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.5583.  MRR so far: 0.0173 0 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.5461.  MRR so far: 0.0176 0 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.5293.  MRR so far: 0.0186 0 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.5156.  MRR so far: 0.0194 0 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.5007.  MRR so far: 0.0204 0 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.4855.  MRR so far: 0.0215 0 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.4728.  MRR so far: 0.0222 0 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.4605.  MRR so far: 0.0226 0 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.4476.  MRR so far: 0.0232 0 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.4355.  MRR so far: 0.0240 0 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.4224.  MRR so far: 0.0247 0 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.4086.  MRR so far: 0.0255 0 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.3981.  MRR so far: 0.0260 0 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.3870.  MRR so far: 0.0267 0 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.3761.  MRR so far: 0.0272 0 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.3623.  MRR so far: 0.0284 0 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.3507.  MRR so far: 0.0288 0 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.3412.  MRR so far: 0.0295 0 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.3310.  MRR so far: 0.0301 0 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.3167.  MRR so far: 0.0310 0 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 6.3065.  MRR so far: 0.0316 0 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 6.2953.  MRR so far: 0.0324 0 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 6.2840.  MRR so far: 0.0331 0 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 6.2725.  MRR so far: 0.0337 0 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 6.2613.  MRR so far: 0.0344 0 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 6.2498.  MRR so far: 0.0351 0 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 6.2411.  MRR so far: 0.0360 0 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 6.2290.  MRR so far: 0.0371 0 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 6.2170.  MRR so far: 0.0377 0 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 6.2050.  MRR so far: 0.0386 0 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 6.1955.  MRR so far: 0.0392 [K  Epoch 0 (train) took 25.53s [processed 1171 samples/second]
 Training Loss: 6.184819
0 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 0 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.2934.  MRR so far: 0.0281 0 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.2856.  MRR so far: 0.0298 0 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.3031.  MRR so far: 0.0304 0 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.2611.  MRR so far: 0.0338 0 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.2721.  MRR so far: 0.0335 0 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.2747.  MRR so far: 0.0326 0 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.2780.  MRR so far: 0.0326 0 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.2693.  MRR so far: 0.0331 0 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.2686.  MRR so far: 0.0326 0 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.2743.  MRR so far: 0.0320 0 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.2814.  MRR so far: 0.0318 0 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.2793.  MRR so far: 0.0316 0 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.2690.  MRR so far: 0.0321 0 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.2676.  MRR so far: 0.0324 0 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.2722.  MRR so far: 0.0318 0 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.2802.  MRR so far: 0.0314 0 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.2833.  MRR so far: 0.0308 0 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.2827.  MRR so far: 0.0306 0 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.2846.  MRR so far: 0.0309 0 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.2822.  MRR so far: 0.0312 0 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.2868.  MRR so far: 0.0309 0 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.2866.  MRR so far: 0.0311 0 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.2832.  MRR so far: 0.0314 0 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.2845.  MRR so far: 0.0313 0 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.2887.  MRR so far: 0.0311 0 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.2950.  MRR so far: 0.0311 0 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.2991.  MRR so far: 0.0309 0 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.3079.  MRR so far: 0.0309 0 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.3302.  MRR so far: 0.0304 0 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.3258.  MRR so far: 0.0307 0 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.3275.  MRR so far: 0.0306 0 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.3219.  MRR so far: 0.0306 0 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.3217.  MRR so far: 0.0307 0 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.3203.  MRR so far: 0.0308 [K  Epoch 0 (valid) took 5.49s [processed 4147 samples/second]
 Validation:  Loss: 6.317896 | MRR: 0.030856
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-27-57_model_best.pkl.gz'.
==== Epoch 1 ====
1 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 1 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.4969.  MRR so far: 0.0907 1 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.4734.  MRR so far: 0.0934 1 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.4562.  MRR so far: 0.0979 1 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.4405.  MRR so far: 0.1003 1 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.4237.  MRR so far: 0.1007 1 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.4052.  MRR so far: 0.1008 1 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.3897.  MRR so far: 0.1016 1 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.3740.  MRR so far: 0.1026 1 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.3664.  MRR so far: 0.1036 1 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.3582.  MRR so far: 0.1048 1 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.3402.  MRR so far: 0.1060 1 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.3228.  MRR so far: 0.1089 1 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.3140.  MRR so far: 0.1099 1 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.2983.  MRR so far: 0.1120 1 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.2797.  MRR so far: 0.1141 1 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.2693.  MRR so far: 0.1149 1 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.2649.  MRR so far: 0.1155 1 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.2570.  MRR so far: 0.1165 1 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.2460.  MRR so far: 0.1172 1 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.2330.  MRR so far: 0.1184 1 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.2278.  MRR so far: 0.1188 1 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.2215.  MRR so far: 0.1200 1 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.2129.  MRR so far: 0.1216 1 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.2072.  MRR so far: 0.1222 1 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 5.1961.  MRR so far: 0.1235 1 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 5.1865.  MRR so far: 0.1246 1 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 5.1809.  MRR so far: 0.1254 1 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 5.1701.  MRR so far: 0.1265 1 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 5.1592.  MRR so far: 0.1280 1 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 5.1514.  MRR so far: 0.1292 1 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 5.1406.  MRR so far: 0.1302 1 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 5.1311.  MRR so far: 0.1314 1 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 5.1205.  MRR so far: 0.1327 1 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 5.1127.  MRR so far: 0.1335 1 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 5.1031.  MRR so far: 0.1342 1 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 5.0928.  MRR so far: 0.1352 1 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 5.0826.  MRR so far: 0.1363 1 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 5.0725.  MRR so far: 0.1376 1 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 5.0655.  MRR so far: 0.1385 1 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 5.0545.  MRR so far: 0.1399 1 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 5.0436.  MRR so far: 0.1416 1 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 5.0339.  MRR so far: 0.1430 1 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 5.0253.  MRR so far: 0.1441 1 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 5.0150.  MRR so far: 0.1453 1 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 5.0056.  MRR so far: 0.1464 [K  Epoch 1 (train) took 14.32s [processed 2088 samples/second]
 Training Loss: 4.996544
1 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 1 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.9582.  MRR so far: 0.0581 1 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.0599.  MRR so far: 0.0585 1 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.0308.  MRR so far: 0.0630 1 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.9723.  MRR so far: 0.0672 1 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.9881.  MRR so far: 0.0663 1 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.0131.  MRR so far: 0.0647 1 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.0147.  MRR so far: 0.0650 1 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.0161.  MRR so far: 0.0652 1 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.0232.  MRR so far: 0.0641 1 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.0223.  MRR so far: 0.0636 1 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.0282.  MRR so far: 0.0643 1 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.0209.  MRR so far: 0.0644 1 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.0068.  MRR so far: 0.0649 1 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.0032.  MRR so far: 0.0647 1 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.0087.  MRR so far: 0.0646 1 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.0241.  MRR so far: 0.0634 1 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.0327.  MRR so far: 0.0618 1 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.0366.  MRR so far: 0.0618 1 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.0508.  MRR so far: 0.0613 1 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.0463.  MRR so far: 0.0611 1 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.0492.  MRR so far: 0.0606 1 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.0508.  MRR so far: 0.0609 1 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.0426.  MRR so far: 0.0612 1 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.0442.  MRR so far: 0.0612 1 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.0556.  MRR so far: 0.0605 1 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.0661.  MRR so far: 0.0599 1 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.0820.  MRR so far: 0.0596 1 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.0916.  MRR so far: 0.0596 1 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.1235.  MRR so far: 0.0589 1 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.1138.  MRR so far: 0.0594 1 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.1200.  MRR so far: 0.0591 1 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.1113.  MRR so far: 0.0592 1 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.1072.  MRR so far: 0.0595 1 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.1060.  MRR so far: 0.0594 [K  Epoch 1 (valid) took 5.09s [processed 4466 samples/second]
 Validation:  Loss: 6.098467 | MRR: 0.059554
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-27-57_model_best.pkl.gz'.
2019-10-18 21:31:22.459942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-10-18 21:31:22.460029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-10-18 21:31:22.460047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-10-18 21:31:22.460058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-10-18 21:31:22.460205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14943 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:00:07.0, compute capability: 7.0)
Test-All MRR (bs=1,000):  0.020
FuncNameTest-All MRR (bs=1,000):  0.018
Validation-All MRR (bs=1,000):  0.019
Test-python MRR (bs=1,000):  0.020
FuncNameTest-python MRR (bs=1,000):  0.018
Validation-python MRR (bs=1,000):  0.019
