2019-10-18 21:36:30.537983: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-18 21:36:30.705851: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-10-18 21:36:30.706823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:00:07.0
totalMemory: 15.75GiB freeMemory: 15.44GiB
2019-10-18 21:36:30.706856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-10-18 21:36:31.218114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-10-18 21:36:31.218183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-10-18 21:36:31.218194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-10-18 21:36:31.218322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14943 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:00:07.0, compute capability: 7.0)
Tokenizing and building vocabulary for code snippets and queries.  This step may take several hours.
Starting training run convselfatt-2019-10-18-21-36-29 of model ConvSelfAttentionModel with following hypers:
{'code_token_vocab_size': 10000, 'code_token_vocab_count_threshold': 10, 'code_token_embedding_size': 128, 'code_use_subtokens': False, 'code_mark_subtoken_end': False, 'code_max_num_tokens': 200, 'code_use_bpe': True, 'code_pct_bpe': 0.5, 'code_1dcnn_position_encoding': 'none', 'code_1dcnn_layer_list': [128, 128], 'code_1dcnn_kernel_width': [8, 8], 'code_1dcnn_add_residual_connections': True, 'code_1dcnn_activation': 'tanh', 'code_self_attention_activation': 'gelu', 'code_self_attention_hidden_size': 128, 'code_self_attention_intermediate_size': 512, 'code_self_attention_num_layers': 2, 'code_self_attention_num_heads': 8, 'code_self_attention_pool_mode': 'weighted_mean', 'query_token_vocab_size': 10000, 'query_token_vocab_count_threshold': 10, 'query_token_embedding_size': 128, 'query_use_subtokens': False, 'query_mark_subtoken_end': False, 'query_max_num_tokens': 30, 'query_use_bpe': True, 'query_pct_bpe': 0.5, 'query_1dcnn_position_encoding': 'none', 'query_1dcnn_layer_list': [128, 128], 'query_1dcnn_kernel_width': [8, 8], 'query_1dcnn_add_residual_connections': True, 'query_1dcnn_activation': 'tanh', 'query_self_attention_activation': 'gelu', 'query_self_attention_hidden_size': 128, 'query_self_attention_intermediate_size': 512, 'query_self_attention_num_layers': 2, 'query_self_attention_num_heads': 8, 'query_self_attention_pool_mode': 'weighted_mean', 'batch_size': 650, 'optimizer': 'Adam', 'seed': 0, 'dropout_keep_rate': 0.9, 'learning_rate': 0.0005, 'learning_rate_code_scale_factor': 1.0, 'learning_rate_query_scale_factor': 1.0, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip': 1, 'loss': 'softmax', 'margin': 1, 'max_epochs': 5, 'patience': 5, 'fraction_using_func_name': 0.1, 'min_len_func_name_for_query': 12, 'query_random_token_frequency': 0.0}
Loading training and validation data.
Begin Training.
Training on 30000 python samples.
Validating on 23107 python samples.
==== Epoch 0 ====
0 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 0 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.7220.  MRR so far: 0.0097 0 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.9478.  MRR so far: 0.0114 0 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.9394.  MRR so far: 0.0116 0 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.8694.  MRR so far: 0.0114 0 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.8111.  MRR so far: 0.0115 0 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.7646.  MRR so far: 0.0118 0 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.7247.  MRR so far: 0.0126 0 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.6937.  MRR so far: 0.0128 0 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.6656.  MRR so far: 0.0135 0 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.6444.  MRR so far: 0.0141 0 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.6243.  MRR so far: 0.0149 0 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.6060.  MRR so far: 0.0155 0 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.5901.  MRR so far: 0.0162 0 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.5751.  MRR so far: 0.0164 0 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.5583.  MRR so far: 0.0173 0 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.5461.  MRR so far: 0.0176 0 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.5293.  MRR so far: 0.0186 0 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.5156.  MRR so far: 0.0194 0 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.5007.  MRR so far: 0.0204 0 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.4855.  MRR so far: 0.0215 0 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.4728.  MRR so far: 0.0222 0 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.4605.  MRR so far: 0.0226 0 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.4476.  MRR so far: 0.0232 0 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.4355.  MRR so far: 0.0240 0 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.4224.  MRR so far: 0.0247 0 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.4086.  MRR so far: 0.0255 0 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.3981.  MRR so far: 0.0260 0 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.3870.  MRR so far: 0.0267 0 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.3761.  MRR so far: 0.0272 0 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.3623.  MRR so far: 0.0284 0 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.3507.  MRR so far: 0.0288 0 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.3412.  MRR so far: 0.0295 0 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.3310.  MRR so far: 0.0301 0 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.3167.  MRR so far: 0.0310 0 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 6.3065.  MRR so far: 0.0316 0 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 6.2953.  MRR so far: 0.0324 0 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 6.2840.  MRR so far: 0.0331 0 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 6.2725.  MRR so far: 0.0337 0 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 6.2613.  MRR so far: 0.0344 0 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 6.2498.  MRR so far: 0.0351 0 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 6.2411.  MRR so far: 0.0360 0 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 6.2290.  MRR so far: 0.0371 0 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 6.2170.  MRR so far: 0.0377 0 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 6.2050.  MRR so far: 0.0386 0 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 6.1955.  MRR so far: 0.0392 [K  Epoch 0 (train) took 18.27s [processed 1636 samples/second]
 Training Loss: 6.184819
0 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 0 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.2934.  MRR so far: 0.0281 0 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.2856.  MRR so far: 0.0298 0 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.3031.  MRR so far: 0.0304 0 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.2611.  MRR so far: 0.0338 0 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.2721.  MRR so far: 0.0335 0 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.2747.  MRR so far: 0.0326 0 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.2780.  MRR so far: 0.0326 0 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.2693.  MRR so far: 0.0331 0 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.2686.  MRR so far: 0.0326 0 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.2743.  MRR so far: 0.0320 0 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.2814.  MRR so far: 0.0318 0 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.2793.  MRR so far: 0.0316 0 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.2690.  MRR so far: 0.0321 0 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.2676.  MRR so far: 0.0324 0 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.2722.  MRR so far: 0.0318 0 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.2802.  MRR so far: 0.0314 0 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.2833.  MRR so far: 0.0308 0 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.2827.  MRR so far: 0.0306 0 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.2846.  MRR so far: 0.0309 0 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.2822.  MRR so far: 0.0312 0 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.2868.  MRR so far: 0.0309 0 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.2866.  MRR so far: 0.0311 0 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.2832.  MRR so far: 0.0314 0 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.2845.  MRR so far: 0.0313 0 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.2887.  MRR so far: 0.0311 0 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.2950.  MRR so far: 0.0311 0 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.2991.  MRR so far: 0.0309 0 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.3079.  MRR so far: 0.0309 0 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.3302.  MRR so far: 0.0304 0 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.3258.  MRR so far: 0.0307 0 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.3275.  MRR so far: 0.0306 0 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.3219.  MRR so far: 0.0306 0 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.3217.  MRR so far: 0.0307 0 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.3203.  MRR so far: 0.0308 [K  Epoch 0 (valid) took 5.39s [processed 4220 samples/second]
 Validation:  Loss: 6.317896 | MRR: 0.030856
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-36-29_model_best.pkl.gz'.
==== Epoch 1 ====
1 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 1 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.4969.  MRR so far: 0.0907 1 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.4734.  MRR so far: 0.0934 1 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.4562.  MRR so far: 0.0979 1 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.4405.  MRR so far: 0.1003 1 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.4237.  MRR so far: 0.1007 1 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.4052.  MRR so far: 0.1008 1 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.3897.  MRR so far: 0.1016 1 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.3740.  MRR so far: 0.1026 1 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.3664.  MRR so far: 0.1036 1 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.3582.  MRR so far: 0.1048 1 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.3402.  MRR so far: 0.1060 1 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.3228.  MRR so far: 0.1089 1 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.3140.  MRR so far: 0.1099 1 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.2983.  MRR so far: 0.1120 1 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.2797.  MRR so far: 0.1141 1 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.2693.  MRR so far: 0.1149 1 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.2649.  MRR so far: 0.1155 1 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.2570.  MRR so far: 0.1165 1 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.2460.  MRR so far: 0.1172 1 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.2330.  MRR so far: 0.1184 1 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.2278.  MRR so far: 0.1188 1 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.2215.  MRR so far: 0.1200 1 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.2129.  MRR so far: 0.1216 1 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.2072.  MRR so far: 0.1222 1 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 5.1961.  MRR so far: 0.1235 1 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 5.1865.  MRR so far: 0.1246 1 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 5.1809.  MRR so far: 0.1254 1 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 5.1701.  MRR so far: 0.1265 1 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 5.1592.  MRR so far: 0.1280 1 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 5.1514.  MRR so far: 0.1292 1 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 5.1406.  MRR so far: 0.1302 1 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 5.1311.  MRR so far: 0.1314 1 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 5.1205.  MRR so far: 0.1326 1 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 5.1127.  MRR so far: 0.1335 1 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 5.1031.  MRR so far: 0.1342 1 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 5.0928.  MRR so far: 0.1352 1 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 5.0826.  MRR so far: 0.1363 1 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 5.0725.  MRR so far: 0.1376 1 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 5.0655.  MRR so far: 0.1385 1 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 5.0545.  MRR so far: 0.1399 1 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 5.0436.  MRR so far: 0.1416 1 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 5.0339.  MRR so far: 0.1430 1 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 5.0253.  MRR so far: 0.1441 1 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 5.0150.  MRR so far: 0.1453 1 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 5.0056.  MRR so far: 0.1464 [K  Epoch 1 (train) took 14.20s [processed 2105 samples/second]
 Training Loss: 4.996544
1 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 1 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.9582.  MRR so far: 0.0581 1 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.0599.  MRR so far: 0.0585 1 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.0308.  MRR so far: 0.0630 1 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.9723.  MRR so far: 0.0672 1 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.9881.  MRR so far: 0.0663 1 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.0130.  MRR so far: 0.0647 1 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.0147.  MRR so far: 0.0650 1 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.0161.  MRR so far: 0.0652 1 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.0232.  MRR so far: 0.0641 1 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.0223.  MRR so far: 0.0636 1 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.0282.  MRR so far: 0.0643 1 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.0209.  MRR so far: 0.0644 1 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.0068.  MRR so far: 0.0649 1 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.0032.  MRR so far: 0.0647 1 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.0087.  MRR so far: 0.0646 1 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.0241.  MRR so far: 0.0634 1 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.0327.  MRR so far: 0.0618 1 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.0366.  MRR so far: 0.0618 1 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.0508.  MRR so far: 0.0613 1 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.0463.  MRR so far: 0.0611 1 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.0492.  MRR so far: 0.0606 1 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.0508.  MRR so far: 0.0609 1 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.0426.  MRR so far: 0.0612 1 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.0442.  MRR so far: 0.0612 1 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.0556.  MRR so far: 0.0605 1 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.0661.  MRR so far: 0.0599 1 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.0820.  MRR so far: 0.0596 1 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.0916.  MRR so far: 0.0596 1 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.1235.  MRR so far: 0.0589 1 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.1138.  MRR so far: 0.0594 1 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.1200.  MRR so far: 0.0591 1 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.1113.  MRR so far: 0.0592 1 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.1072.  MRR so far: 0.0595 1 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.1060.  MRR so far: 0.0594 [K  Epoch 1 (valid) took 5.06s [processed 4497 samples/second]
 Validation:  Loss: 6.098466 | MRR: 0.059554
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-36-29_model_best.pkl.gz'.
==== Epoch 2 ====
2 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 2 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 4.2029.  MRR so far: 0.2554 2 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 4.2302.  MRR so far: 0.2471 2 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 4.2076.  MRR so far: 0.2527 2 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 4.1995.  MRR so far: 0.2523 2 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 4.1646.  MRR so far: 0.2560 2 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 4.1472.  MRR so far: 0.2580 2 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 4.1230.  MRR so far: 0.2613 2 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 4.1133.  MRR so far: 0.2613 2 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 4.0949.  MRR so far: 0.2644 2 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 4.0967.  MRR so far: 0.2649 2 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 4.0797.  MRR so far: 0.2674 2 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 4.0692.  MRR so far: 0.2702 2 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 4.0615.  MRR so far: 0.2718 2 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 4.0551.  MRR so far: 0.2738 2 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 4.0473.  MRR so far: 0.2749 2 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 4.0326.  MRR so far: 0.2784 2 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 4.0267.  MRR so far: 0.2796 2 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 4.0214.  MRR so far: 0.2808 2 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 4.0122.  MRR so far: 0.2825 2 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 4.0079.  MRR so far: 0.2833 2 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 3.9948.  MRR so far: 0.2855 2 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 3.9812.  MRR so far: 0.2875 2 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 3.9745.  MRR so far: 0.2887 2 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 3.9640.  MRR so far: 0.2897 2 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 3.9601.  MRR so far: 0.2898 2 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 3.9458.  MRR so far: 0.2918 2 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 3.9339.  MRR so far: 0.2934 2 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 3.9257.  MRR so far: 0.2946 2 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 3.9174.  MRR so far: 0.2966 2 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 3.9120.  MRR so far: 0.2971 2 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 3.9007.  MRR so far: 0.2988 2 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 3.8931.  MRR so far: 0.3007 2 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 3.8858.  MRR so far: 0.3021 2 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 3.8781.  MRR so far: 0.3035 2 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 3.8742.  MRR so far: 0.3041 2 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 3.8687.  MRR so far: 0.3050 2 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 3.8629.  MRR so far: 0.3063 2 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 3.8554.  MRR so far: 0.3077 2 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 3.8472.  MRR so far: 0.3091 2 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 3.8403.  MRR so far: 0.3098 2 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 3.8312.  MRR so far: 0.3113 2 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 3.8259.  MRR so far: 0.3120 2 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 3.8185.  MRR so far: 0.3133 2 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 3.8111.  MRR so far: 0.3143 2 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 3.8026.  MRR so far: 0.3158 [K  Epoch 2 (train) took 14.20s [processed 2105 samples/second]
 Training Loss: 3.794147
2 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 2 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.5968.  MRR so far: 0.1239 2 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.7807.  MRR so far: 0.1135 2 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.7574.  MRR so far: 0.1101 2 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.6784.  MRR so far: 0.1225 2 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.7199.  MRR so far: 0.1181 2 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.7703.  MRR so far: 0.1131 2 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.7881.  MRR so far: 0.1125 2 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.7916.  MRR so far: 0.1113 2 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.7994.  MRR so far: 0.1093 2 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.8077.  MRR so far: 0.1089 2 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.8225.  MRR so far: 0.1091 2 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.8128.  MRR so far: 0.1090 2 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.7960.  MRR so far: 0.1101 2 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.7963.  MRR so far: 0.1094 2 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.8057.  MRR so far: 0.1079 2 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.8273.  MRR so far: 0.1062 2 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.8404.  MRR so far: 0.1036 2 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.8379.  MRR so far: 0.1033 2 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.8656.  MRR so far: 0.1017 2 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.8528.  MRR so far: 0.1019 2 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.8627.  MRR so far: 0.1020 2 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.8637.  MRR so far: 0.1022 2 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.8522.  MRR so far: 0.1026 2 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.8546.  MRR so far: 0.1026 2 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 5.8752.  MRR so far: 0.1014 2 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 5.8968.  MRR so far: 0.1002 2 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 5.9133.  MRR so far: 0.0996 2 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 5.9326.  MRR so far: 0.0990 2 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 5.9939.  MRR so far: 0.0981 2 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 5.9839.  MRR so far: 0.0986 2 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.0047.  MRR so far: 0.0978 2 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 5.9915.  MRR so far: 0.0983 2 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 5.9880.  MRR so far: 0.0983 2 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 5.9887.  MRR so far: 0.0976 [K  Epoch 2 (valid) took 5.06s [processed 4494 samples/second]
 Validation:  Loss: 5.977056 | MRR: 0.097984
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-36-29_model_best.pkl.gz'.
==== Epoch 3 ====
3 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 3 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 3.0408.  MRR so far: 0.4385 3 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 3.0029.  MRR so far: 0.4493 3 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 2.9729.  MRR so far: 0.4518 3 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 2.9639.  MRR so far: 0.4548 3 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 2.9533.  MRR so far: 0.4551 3 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 2.9468.  MRR so far: 0.4591 3 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 2.9654.  MRR so far: 0.4557 3 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 2.9340.  MRR so far: 0.4610 3 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 2.9141.  MRR so far: 0.4654 3 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 2.9063.  MRR so far: 0.4656 3 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 2.9162.  MRR so far: 0.4639 3 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 2.9108.  MRR so far: 0.4655 3 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 2.9022.  MRR so far: 0.4670 3 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 2.8893.  MRR so far: 0.4697 3 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 2.8851.  MRR so far: 0.4704 3 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 2.8706.  MRR so far: 0.4728 3 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 2.8730.  MRR so far: 0.4724 3 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 2.8737.  MRR so far: 0.4719 3 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 2.8661.  MRR so far: 0.4731 3 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 2.8612.  MRR so far: 0.4744 3 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 2.8615.  MRR so far: 0.4747 3 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 2.8563.  MRR so far: 0.4755 3 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 2.8511.  MRR so far: 0.4768 3 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 2.8417.  MRR so far: 0.4782 3 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 2.8385.  MRR so far: 0.4783 3 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 2.8385.  MRR so far: 0.4784 3 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 2.8335.  MRR so far: 0.4796 3 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 2.8321.  MRR so far: 0.4799 3 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 2.8299.  MRR so far: 0.4801 3 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 2.8243.  MRR so far: 0.4811 3 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 2.8237.  MRR so far: 0.4809 3 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 2.8217.  MRR so far: 0.4815 3 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 2.8167.  MRR so far: 0.4825 3 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 2.8088.  MRR so far: 0.4839 3 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 2.8040.  MRR so far: 0.4845 3 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 2.8039.  MRR so far: 0.4846 3 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 2.7976.  MRR so far: 0.4856 3 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 2.7954.  MRR so far: 0.4860 3 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 2.7895.  MRR so far: 0.4871 3 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 2.7850.  MRR so far: 0.4878 3 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 2.7808.  MRR so far: 0.4888 3 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 2.7825.  MRR so far: 0.4885 3 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 2.7806.  MRR so far: 0.4888 3 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 2.7754.  MRR so far: 0.4898 3 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 2.7704.  MRR so far: 0.4908 [K  Epoch 3 (train) took 14.19s [processed 2106 samples/second]
 Training Loss: 2.772033
3 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 3 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.5686.  MRR so far: 0.1555 3 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.7489.  MRR so far: 0.1437 3 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.7643.  MRR so far: 0.1401 3 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.7137.  MRR so far: 0.1502 3 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.7543.  MRR so far: 0.1454 3 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.8382.  MRR so far: 0.1392 3 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.8537.  MRR so far: 0.1388 3 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.8551.  MRR so far: 0.1388 3 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.8672.  MRR so far: 0.1371 3 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.8508.  MRR so far: 0.1385 3 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.8600.  MRR so far: 0.1393 3 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.8491.  MRR so far: 0.1390 3 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.8420.  MRR so far: 0.1394 3 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.8432.  MRR so far: 0.1390 3 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.8604.  MRR so far: 0.1375 3 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.8787.  MRR so far: 0.1355 3 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.8801.  MRR so far: 0.1336 3 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.9043.  MRR so far: 0.1331 3 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.9377.  MRR so far: 0.1315 3 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.9296.  MRR so far: 0.1312 3 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.9374.  MRR so far: 0.1305 3 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.9328.  MRR so far: 0.1307 3 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.9207.  MRR so far: 0.1311 3 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.9256.  MRR so far: 0.1309 3 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 5.9463.  MRR so far: 0.1292 3 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 5.9711.  MRR so far: 0.1279 3 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.0057.  MRR so far: 0.1274 3 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.0386.  MRR so far: 0.1271 3 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.1273.  MRR so far: 0.1257 3 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.1192.  MRR so far: 0.1263 3 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.1486.  MRR so far: 0.1250 3 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.1274.  MRR so far: 0.1258 3 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.1205.  MRR so far: 0.1260 3 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.1169.  MRR so far: 0.1255 [K  Epoch 3 (valid) took 5.07s [processed 4484 samples/second]
 Validation:  Loss: 6.102100 | MRR: 0.126301
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-36-29_model_best.pkl.gz'.
==== Epoch 4 ====
4 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 4 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 2.2966.  MRR so far: 0.5682 4 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 2.2454.  MRR so far: 0.5814 4 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 2.2532.  MRR so far: 0.5826 4 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 2.1990.  MRR so far: 0.5951 4 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 2.1539.  MRR so far: 0.6054 4 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 2.1456.  MRR so far: 0.6075 4 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 2.1563.  MRR so far: 0.6044 4 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 2.1551.  MRR so far: 0.6044 4 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 2.1311.  MRR so far: 0.6080 4 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 2.1334.  MRR so far: 0.6087 4 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 2.1269.  MRR so far: 0.6102 4 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 2.1189.  MRR so far: 0.6109 4 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 2.1084.  MRR so far: 0.6130 4 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 2.1056.  MRR so far: 0.6138 4 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 2.0993.  MRR so far: 0.6153 4 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 2.1027.  MRR so far: 0.6149 4 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 2.0995.  MRR so far: 0.6152 4 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 2.1024.  MRR so far: 0.6146 4 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 2.1085.  MRR so far: 0.6133 4 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 2.1105.  MRR so far: 0.6131 4 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 2.1132.  MRR so far: 0.6120 4 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 2.1213.  MRR so far: 0.6110 4 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 2.1162.  MRR so far: 0.6122 4 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 2.1135.  MRR so far: 0.6131 4 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 2.1026.  MRR so far: 0.6147 4 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 2.1063.  MRR so far: 0.6142 4 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 2.1049.  MRR so far: 0.6141 4 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 2.1076.  MRR so far: 0.6133 4 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 2.1082.  MRR so far: 0.6127 4 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 2.1023.  MRR so far: 0.6140 4 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 2.1001.  MRR so far: 0.6147 4 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 2.0929.  MRR so far: 0.6159 4 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 2.0942.  MRR so far: 0.6157 4 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 2.0913.  MRR so far: 0.6159 4 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 2.0922.  MRR so far: 0.6156 4 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 2.0925.  MRR so far: 0.6152 4 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 2.0914.  MRR so far: 0.6157 4 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 2.0933.  MRR so far: 0.6153 4 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 2.0884.  MRR so far: 0.6162 4 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 2.0847.  MRR so far: 0.6170 4 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 2.0832.  MRR so far: 0.6171 4 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 2.0821.  MRR so far: 0.6174 4 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 2.0835.  MRR so far: 0.6171 4 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 2.0825.  MRR so far: 0.6173 4 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 2.0834.  MRR so far: 0.6172 [K  Epoch 4 (train) took 14.21s [processed 2103 samples/second]
 Training Loss: 2.081079
4 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 4 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.5271.  MRR so far: 0.2074 4 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.9256.  MRR so far: 0.1856 4 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.9203.  MRR so far: 0.1750 4 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.8274.  MRR so far: 0.1859 4 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.8742.  MRR so far: 0.1773 4 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.9715.  MRR so far: 0.1712 4 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.9856.  MRR so far: 0.1695 4 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.9999.  MRR so far: 0.1690 4 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.0149.  MRR so far: 0.1659 4 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.0081.  MRR so far: 0.1661 4 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.0098.  MRR so far: 0.1659 4 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.9982.  MRR so far: 0.1665 4 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.9715.  MRR so far: 0.1686 4 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.9672.  MRR so far: 0.1681 4 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.9703.  MRR so far: 0.1658 4 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.9945.  MRR so far: 0.1637 4 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.0056.  MRR so far: 0.1601 4 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.0223.  MRR so far: 0.1592 4 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.0616.  MRR so far: 0.1565 4 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.0461.  MRR so far: 0.1567 4 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.0630.  MRR so far: 0.1562 4 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.0585.  MRR so far: 0.1565 4 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.0441.  MRR so far: 0.1571 4 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.0513.  MRR so far: 0.1567 4 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.0883.  MRR so far: 0.1540 4 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.1214.  MRR so far: 0.1519 4 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.1497.  MRR so far: 0.1513 4 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.1783.  MRR so far: 0.1511 4 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.2763.  MRR so far: 0.1491 4 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.2664.  MRR so far: 0.1497 4 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.3074.  MRR so far: 0.1478 4 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.2796.  MRR so far: 0.1490 4 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.2705.  MRR so far: 0.1489 4 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.2690.  MRR so far: 0.1483 [K  Epoch 4 (valid) took 5.08s [processed 4480 samples/second]
 Validation:  Loss: 6.253099 | MRR: 0.148699
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-36-29_model_best.pkl.gz'.
2019-10-18 21:40:48.824804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-10-18 21:40:48.824877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-10-18 21:40:48.824888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-10-18 21:40:48.824904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-10-18 21:40:48.825012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14943 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:00:07.0, compute capability: 7.0)
Test-All MRR (bs=1,000):  0.127
FuncNameTest-All MRR (bs=1,000):  0.114
Validation-All MRR (bs=1,000):  0.111
Test-python MRR (bs=1,000):  0.127
FuncNameTest-python MRR (bs=1,000):  0.114
Validation-python MRR (bs=1,000):  0.111
