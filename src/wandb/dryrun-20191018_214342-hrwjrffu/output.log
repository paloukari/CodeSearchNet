2019-10-18 21:43:44.008037: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-18 21:43:44.173559: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-10-18 21:43:44.174566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla V100-PCIE-16GB major: 7 minor: 0 memoryClockRate(GHz): 1.38
pciBusID: 0000:00:07.0
totalMemory: 15.75GiB freeMemory: 15.44GiB
2019-10-18 21:43:44.174605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-10-18 21:43:44.685126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-10-18 21:43:44.685213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-10-18 21:43:44.685230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-10-18 21:43:44.685382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14943 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:00:07.0, compute capability: 7.0)
Tokenizing and building vocabulary for code snippets and queries.  This step may take several hours.
Starting training run convselfatt-2019-10-18-21-43-42 of model ConvSelfAttentionModel with following hypers:
{'code_token_vocab_size': 10000, 'code_token_vocab_count_threshold': 10, 'code_token_embedding_size': 128, 'code_use_subtokens': False, 'code_mark_subtoken_end': False, 'code_max_num_tokens': 200, 'code_use_bpe': True, 'code_pct_bpe': 0.5, 'code_1dcnn_position_encoding': 'none', 'code_1dcnn_layer_list': [128, 128], 'code_1dcnn_kernel_width': [8, 8], 'code_1dcnn_add_residual_connections': True, 'code_1dcnn_activation': 'tanh', 'code_self_attention_activation': 'gelu', 'code_self_attention_hidden_size': 128, 'code_self_attention_intermediate_size': 512, 'code_self_attention_num_layers': 2, 'code_self_attention_num_heads': 8, 'code_self_attention_pool_mode': 'weighted_mean', 'query_token_vocab_size': 10000, 'query_token_vocab_count_threshold': 10, 'query_token_embedding_size': 128, 'query_use_subtokens': False, 'query_mark_subtoken_end': False, 'query_max_num_tokens': 30, 'query_use_bpe': True, 'query_pct_bpe': 0.5, 'query_1dcnn_position_encoding': 'none', 'query_1dcnn_layer_list': [128, 128], 'query_1dcnn_kernel_width': [8, 8], 'query_1dcnn_add_residual_connections': True, 'query_1dcnn_activation': 'tanh', 'query_self_attention_activation': 'gelu', 'query_self_attention_hidden_size': 128, 'query_self_attention_intermediate_size': 512, 'query_self_attention_num_layers': 2, 'query_self_attention_num_heads': 8, 'query_self_attention_pool_mode': 'weighted_mean', 'batch_size': 650, 'optimizer': 'Adam', 'seed': 0, 'dropout_keep_rate': 0.9, 'learning_rate': 0.0005, 'learning_rate_code_scale_factor': 1.0, 'learning_rate_query_scale_factor': 1.0, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip': 1, 'loss': 'softmax', 'margin': 1, 'max_epochs': 15, 'patience': 5, 'fraction_using_func_name': 0.1, 'min_len_func_name_for_query': 12, 'query_random_token_frequency': 0.0}
Loading training and validation data.
Begin Training.
Training on 30000 python samples.
Validating on 23107 python samples.
==== Epoch 0 ====
0 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 0 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.7142.  MRR so far: 0.0099 0 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.9486.  MRR so far: 0.0115 0 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.9418.  MRR so far: 0.0118 0 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.8734.  MRR so far: 0.0114 0 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.8147.  MRR so far: 0.0115 0 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.7673.  MRR so far: 0.0117 0 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.7272.  MRR so far: 0.0123 0 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.6954.  MRR so far: 0.0126 0 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.6673.  MRR so far: 0.0130 0 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.6457.  MRR so far: 0.0136 0 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.6258.  MRR so far: 0.0142 0 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.6074.  MRR so far: 0.0147 0 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.5910.  MRR so far: 0.0155 0 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.5759.  MRR so far: 0.0159 0 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.5589.  MRR so far: 0.0167 0 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.5464.  MRR so far: 0.0171 0 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.5298.  MRR so far: 0.0181 0 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.5159.  MRR so far: 0.0191 0 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.5007.  MRR so far: 0.0200 0 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.4854.  MRR so far: 0.0210 0 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.4727.  MRR so far: 0.0217 0 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.4599.  MRR so far: 0.0221 0 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.4471.  MRR so far: 0.0228 0 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.4349.  MRR so far: 0.0236 0 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.4217.  MRR so far: 0.0242 0 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.4080.  MRR so far: 0.0250 0 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.3972.  MRR so far: 0.0257 0 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.3858.  MRR so far: 0.0262 0 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.3739.  MRR so far: 0.0268 0 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.3601.  MRR so far: 0.0280 0 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.3486.  MRR so far: 0.0285 0 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.3381.  MRR so far: 0.0292 0 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.3271.  MRR so far: 0.0299 0 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.3129.  MRR so far: 0.0307 0 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 6.3028.  MRR so far: 0.0315 0 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 6.2908.  MRR so far: 0.0323 0 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 6.2777.  MRR so far: 0.0333 0 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 6.2653.  MRR so far: 0.0340 0 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 6.2538.  MRR so far: 0.0347 0 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 6.2426.  MRR so far: 0.0354 0 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 6.2340.  MRR so far: 0.0363 0 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 6.2203.  MRR so far: 0.0374 0 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 6.2071.  MRR so far: 0.0381 0 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 6.1953.  MRR so far: 0.0389 0 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 6.1857.  MRR so far: 0.0395 [K  Epoch 0 (train) took 18.20s [processed 1643 samples/second]
 Training Loss: 6.173519
0 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 0 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.2125.  MRR so far: 0.0345 0 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.2484.  MRR so far: 0.0321 0 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.2661.  MRR so far: 0.0333 0 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.2334.  MRR so far: 0.0365 0 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.2451.  MRR so far: 0.0348 0 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.2533.  MRR so far: 0.0336 0 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.2555.  MRR so far: 0.0335 0 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.2478.  MRR so far: 0.0341 0 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.2514.  MRR so far: 0.0331 0 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.2564.  MRR so far: 0.0326 0 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.2645.  MRR so far: 0.0325 0 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.2618.  MRR so far: 0.0323 0 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.2520.  MRR so far: 0.0333 0 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.2485.  MRR so far: 0.0336 0 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.2509.  MRR so far: 0.0331 0 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.2599.  MRR so far: 0.0330 0 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.2633.  MRR so far: 0.0323 0 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.2629.  MRR so far: 0.0322 0 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.2663.  MRR so far: 0.0322 0 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.2659.  MRR so far: 0.0326 0 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.2702.  MRR so far: 0.0326 0 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.2713.  MRR so far: 0.0325 0 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.2676.  MRR so far: 0.0326 0 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.2692.  MRR so far: 0.0326 0 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.2753.  MRR so far: 0.0322 0 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.2807.  MRR so far: 0.0320 0 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.2846.  MRR so far: 0.0319 0 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.2940.  MRR so far: 0.0318 0 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.3151.  MRR so far: 0.0313 0 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.3111.  MRR so far: 0.0316 0 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.3126.  MRR so far: 0.0316 0 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.3065.  MRR so far: 0.0318 0 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.3061.  MRR so far: 0.0320 0 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.3050.  MRR so far: 0.0320 [K  Epoch 0 (valid) took 5.37s [processed 4237 samples/second]
 Validation:  Loss: 6.302981 | MRR: 0.032015
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 1 ====
1 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 1 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.4221.  MRR so far: 0.1039 1 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.4078.  MRR so far: 0.1055 1 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.4054.  MRR so far: 0.1067 1 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.3879.  MRR so far: 0.1095 1 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.3643.  MRR so far: 0.1107 1 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.3398.  MRR so far: 0.1121 1 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.3198.  MRR so far: 0.1126 1 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.3051.  MRR so far: 0.1124 1 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.2951.  MRR so far: 0.1126 1 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.2863.  MRR so far: 0.1136 1 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.2685.  MRR so far: 0.1150 1 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.2529.  MRR so far: 0.1174 1 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.2442.  MRR so far: 0.1186 1 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.2290.  MRR so far: 0.1206 1 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.2125.  MRR so far: 0.1225 1 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.2023.  MRR so far: 0.1234 1 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.1968.  MRR so far: 0.1239 1 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.1898.  MRR so far: 0.1244 1 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.1808.  MRR so far: 0.1248 1 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.1681.  MRR so far: 0.1255 1 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.1630.  MRR so far: 0.1262 1 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.1543.  MRR so far: 0.1276 1 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.1452.  MRR so far: 0.1294 1 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.1399.  MRR so far: 0.1300 1 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 5.1303.  MRR so far: 0.1313 1 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 5.1215.  MRR so far: 0.1323 1 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 5.1165.  MRR so far: 0.1329 1 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 5.1060.  MRR so far: 0.1338 1 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 5.0961.  MRR so far: 0.1351 1 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 5.0890.  MRR so far: 0.1361 1 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 5.0778.  MRR so far: 0.1372 1 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 5.0677.  MRR so far: 0.1385 1 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 5.0584.  MRR so far: 0.1396 1 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 5.0523.  MRR so far: 0.1403 1 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 5.0423.  MRR so far: 0.1411 1 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 5.0323.  MRR so far: 0.1424 1 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 5.0221.  MRR so far: 0.1437 1 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 5.0129.  MRR so far: 0.1451 1 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 5.0063.  MRR so far: 0.1461 1 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 4.9962.  MRR so far: 0.1472 1 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 4.9854.  MRR so far: 0.1487 1 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 4.9769.  MRR so far: 0.1499 1 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 4.9681.  MRR so far: 0.1507 1 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 4.9579.  MRR so far: 0.1517 1 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 4.9490.  MRR so far: 0.1528 [K  Epoch 1 (train) took 14.18s [processed 2108 samples/second]
 Training Loss: 4.939659
1 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 1 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.8892.  MRR so far: 0.0644 1 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.9926.  MRR so far: 0.0630 1 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.9848.  MRR so far: 0.0651 1 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.9358.  MRR so far: 0.0680 1 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.9533.  MRR so far: 0.0659 1 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.9843.  MRR so far: 0.0647 1 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.9944.  MRR so far: 0.0650 1 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.0001.  MRR so far: 0.0656 1 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.0074.  MRR so far: 0.0652 1 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.0060.  MRR so far: 0.0645 1 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.0152.  MRR so far: 0.0647 1 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.0053.  MRR so far: 0.0645 1 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.9919.  MRR so far: 0.0654 1 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.9876.  MRR so far: 0.0660 1 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.9938.  MRR so far: 0.0660 1 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.0072.  MRR so far: 0.0650 1 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.0118.  MRR so far: 0.0637 1 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.0164.  MRR so far: 0.0636 1 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.0303.  MRR so far: 0.0632 1 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.0271.  MRR so far: 0.0630 1 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.0314.  MRR so far: 0.0624 1 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.0341.  MRR so far: 0.0625 1 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.0284.  MRR so far: 0.0627 1 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.0301.  MRR so far: 0.0628 1 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.0401.  MRR so far: 0.0623 1 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.0490.  MRR so far: 0.0617 1 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.0664.  MRR so far: 0.0614 1 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.0791.  MRR so far: 0.0615 1 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.1178.  MRR so far: 0.0608 1 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.1083.  MRR so far: 0.0614 1 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.1151.  MRR so far: 0.0612 1 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.1066.  MRR so far: 0.0613 1 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.1019.  MRR so far: 0.0615 1 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.0997.  MRR so far: 0.0615 [K  Epoch 1 (valid) took 5.03s [processed 4523 samples/second]
 Validation:  Loss: 6.090662 | MRR: 0.061688
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 2 ====
2 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 2 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 4.1338.  MRR so far: 0.2642 2 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 4.1807.  MRR so far: 0.2515 2 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 4.1567.  MRR so far: 0.2592 2 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 4.1433.  MRR so far: 0.2560 2 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 4.1149.  MRR so far: 0.2583 2 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 4.1080.  MRR so far: 0.2590 2 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 4.0915.  MRR so far: 0.2619 2 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 4.0891.  MRR so far: 0.2612 2 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 4.0716.  MRR so far: 0.2653 2 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 4.0698.  MRR so far: 0.2664 2 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 4.0501.  MRR so far: 0.2689 2 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 4.0422.  MRR so far: 0.2721 2 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 4.0294.  MRR so far: 0.2741 2 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 4.0228.  MRR so far: 0.2763 2 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 4.0133.  MRR so far: 0.2777 2 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 4.0028.  MRR so far: 0.2799 2 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 3.9990.  MRR so far: 0.2811 2 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 3.9930.  MRR so far: 0.2822 2 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 3.9814.  MRR so far: 0.2842 2 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 3.9740.  MRR so far: 0.2855 2 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 3.9603.  MRR so far: 0.2880 2 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 3.9499.  MRR so far: 0.2898 2 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 3.9430.  MRR so far: 0.2908 2 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 3.9315.  MRR so far: 0.2923 2 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 3.9292.  MRR so far: 0.2926 2 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 3.9159.  MRR so far: 0.2945 2 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 3.9045.  MRR so far: 0.2960 2 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 3.9001.  MRR so far: 0.2970 2 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 3.8962.  MRR so far: 0.2982 2 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 3.8920.  MRR so far: 0.2987 2 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 3.8837.  MRR so far: 0.3003 2 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 3.8803.  MRR so far: 0.3017 2 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 3.8767.  MRR so far: 0.3025 2 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 3.8707.  MRR so far: 0.3038 2 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 3.8652.  MRR so far: 0.3048 2 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 3.8608.  MRR so far: 0.3051 2 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 3.8557.  MRR so far: 0.3058 2 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 3.8485.  MRR so far: 0.3069 2 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 3.8411.  MRR so far: 0.3082 2 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 3.8341.  MRR so far: 0.3093 2 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 3.8270.  MRR so far: 0.3105 2 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 3.8211.  MRR so far: 0.3113 2 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 3.8138.  MRR so far: 0.3127 2 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 3.8084.  MRR so far: 0.3135 2 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 3.8017.  MRR so far: 0.3146 [K  Epoch 2 (train) took 14.15s [processed 2113 samples/second]
 Training Loss: 3.794355
2 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 2 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.5837.  MRR so far: 0.1147 2 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.7555.  MRR so far: 0.1104 2 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.7372.  MRR so far: 0.1078 2 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.6546.  MRR so far: 0.1176 2 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.7123.  MRR so far: 0.1137 2 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.7735.  MRR so far: 0.1077 2 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.7838.  MRR so far: 0.1074 2 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.7906.  MRR so far: 0.1072 2 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.7973.  MRR so far: 0.1052 2 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.8040.  MRR so far: 0.1044 2 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.8177.  MRR so far: 0.1046 2 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.8088.  MRR so far: 0.1047 2 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.7887.  MRR so far: 0.1063 2 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.7869.  MRR so far: 0.1061 2 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.7937.  MRR so far: 0.1051 2 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.8143.  MRR so far: 0.1037 2 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.8255.  MRR so far: 0.1014 2 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.8228.  MRR so far: 0.1016 2 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.8494.  MRR so far: 0.0998 2 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.8355.  MRR so far: 0.0999 2 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.8448.  MRR so far: 0.0996 2 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.8447.  MRR so far: 0.1000 2 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.8342.  MRR so far: 0.1006 2 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.8354.  MRR so far: 0.1008 2 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 5.8590.  MRR so far: 0.0994 2 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 5.8815.  MRR so far: 0.0984 2 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 5.8988.  MRR so far: 0.0978 2 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 5.9202.  MRR so far: 0.0971 2 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 5.9786.  MRR so far: 0.0962 2 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 5.9700.  MRR so far: 0.0964 2 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 5.9901.  MRR so far: 0.0958 2 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 5.9767.  MRR so far: 0.0964 2 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 5.9723.  MRR so far: 0.0965 2 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 5.9724.  MRR so far: 0.0959 [K  Epoch 2 (valid) took 5.03s [processed 4522 samples/second]
 Validation:  Loss: 5.962158 | MRR: 0.096258
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 3 ====
3 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 3 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 3.1353.  MRR so far: 0.4289 3 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 3.0814.  MRR so far: 0.4398 3 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 3.0403.  MRR so far: 0.4407 3 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 3.0284.  MRR so far: 0.4452 3 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 3.0270.  MRR so far: 0.4446 3 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 3.0113.  MRR so far: 0.4504 3 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 3.0169.  MRR so far: 0.4479 3 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 2.9904.  MRR so far: 0.4518 3 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 2.9759.  MRR so far: 0.4549 3 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 2.9688.  MRR so far: 0.4545 3 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 2.9800.  MRR so far: 0.4524 3 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 2.9813.  MRR so far: 0.4523 3 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 2.9719.  MRR so far: 0.4535 3 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 2.9578.  MRR so far: 0.4562 3 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 2.9533.  MRR so far: 0.4571 3 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 2.9404.  MRR so far: 0.4589 3 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 2.9400.  MRR so far: 0.4589 3 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 2.9412.  MRR so far: 0.4588 3 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 2.9347.  MRR so far: 0.4599 3 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 2.9281.  MRR so far: 0.4612 3 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 2.9249.  MRR so far: 0.4619 3 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 2.9225.  MRR so far: 0.4622 3 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 2.9214.  MRR so far: 0.4627 3 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 2.9114.  MRR so far: 0.4641 3 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 2.9060.  MRR so far: 0.4648 3 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 2.9042.  MRR so far: 0.4652 3 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 2.8998.  MRR so far: 0.4663 3 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 2.8990.  MRR so far: 0.4662 3 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 2.8977.  MRR so far: 0.4661 3 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 2.8908.  MRR so far: 0.4673 3 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 2.8859.  MRR so far: 0.4682 3 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 2.8852.  MRR so far: 0.4685 3 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 2.8817.  MRR so far: 0.4695 3 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 2.8749.  MRR so far: 0.4709 3 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 2.8683.  MRR so far: 0.4716 3 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 2.8674.  MRR so far: 0.4720 3 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 2.8615.  MRR so far: 0.4728 3 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 2.8598.  MRR so far: 0.4730 3 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 2.8535.  MRR so far: 0.4744 3 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 2.8487.  MRR so far: 0.4750 3 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 2.8431.  MRR so far: 0.4763 3 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 2.8446.  MRR so far: 0.4761 3 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 2.8408.  MRR so far: 0.4766 3 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 2.8348.  MRR so far: 0.4777 3 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 2.8296.  MRR so far: 0.4788 [K  Epoch 3 (train) took 14.18s [processed 2109 samples/second]
 Training Loss: 2.829426
3 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 3 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.5855.  MRR so far: 0.1631 3 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.6891.  MRR so far: 0.1483 3 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.6954.  MRR so far: 0.1451 3 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.6771.  MRR so far: 0.1517 3 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.7307.  MRR so far: 0.1466 3 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.8146.  MRR so far: 0.1397 3 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.8296.  MRR so far: 0.1403 3 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.8445.  MRR so far: 0.1398 3 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.8622.  MRR so far: 0.1376 3 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.8569.  MRR so far: 0.1384 3 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.8571.  MRR so far: 0.1389 3 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.8473.  MRR so far: 0.1392 3 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.8317.  MRR so far: 0.1403 3 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.8333.  MRR so far: 0.1394 3 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.8454.  MRR so far: 0.1383 3 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.8599.  MRR so far: 0.1366 3 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.8604.  MRR so far: 0.1345 3 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.8779.  MRR so far: 0.1344 3 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.9072.  MRR so far: 0.1327 3 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.8913.  MRR so far: 0.1329 3 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.9005.  MRR so far: 0.1326 3 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.8988.  MRR so far: 0.1326 3 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.8869.  MRR so far: 0.1333 3 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.8934.  MRR so far: 0.1331 3 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 5.9146.  MRR so far: 0.1313 3 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 5.9418.  MRR so far: 0.1300 3 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 5.9776.  MRR so far: 0.1293 3 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.0214.  MRR so far: 0.1288 3 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.1239.  MRR so far: 0.1274 3 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.1131.  MRR so far: 0.1283 3 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.1482.  MRR so far: 0.1268 3 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.1269.  MRR so far: 0.1276 3 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.1165.  MRR so far: 0.1277 3 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.1140.  MRR so far: 0.1272 [K  Epoch 3 (valid) took 5.02s [processed 4531 samples/second]
 Validation:  Loss: 6.097715 | MRR: 0.127784
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 4 ====
4 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 4 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 2.3446.  MRR so far: 0.5662 4 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 2.3711.  MRR so far: 0.5662 4 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 2.3643.  MRR so far: 0.5640 4 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 2.2900.  MRR so far: 0.5788 4 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 2.2480.  MRR so far: 0.5877 4 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 2.2297.  MRR so far: 0.5897 4 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 2.2303.  MRR so far: 0.5896 4 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 2.2326.  MRR so far: 0.5896 4 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 2.2057.  MRR so far: 0.5955 4 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 2.2034.  MRR so far: 0.5967 4 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 2.1961.  MRR so far: 0.5984 4 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 2.1831.  MRR so far: 0.6007 4 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 2.1717.  MRR so far: 0.6020 4 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 2.1653.  MRR so far: 0.6038 4 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 2.1571.  MRR so far: 0.6050 4 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 2.1590.  MRR so far: 0.6052 4 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 2.1564.  MRR so far: 0.6054 4 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 2.1580.  MRR so far: 0.6042 4 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 2.1663.  MRR so far: 0.6023 4 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 2.1679.  MRR so far: 0.6021 4 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 2.1701.  MRR so far: 0.6017 4 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 2.1754.  MRR so far: 0.6009 4 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 2.1684.  MRR so far: 0.6020 4 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 2.1661.  MRR so far: 0.6027 4 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 2.1542.  MRR so far: 0.6047 4 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 2.1571.  MRR so far: 0.6047 4 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 2.1569.  MRR so far: 0.6045 4 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 2.1603.  MRR so far: 0.6038 4 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 2.1602.  MRR so far: 0.6033 4 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 2.1552.  MRR so far: 0.6041 4 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 2.1530.  MRR so far: 0.6046 4 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 2.1452.  MRR so far: 0.6060 4 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 2.1471.  MRR so far: 0.6059 4 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 2.1436.  MRR so far: 0.6063 4 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 2.1438.  MRR so far: 0.6063 4 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 2.1445.  MRR so far: 0.6058 4 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 2.1441.  MRR so far: 0.6061 4 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 2.1448.  MRR so far: 0.6059 4 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 2.1385.  MRR so far: 0.6072 4 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 2.1352.  MRR so far: 0.6079 4 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 2.1351.  MRR so far: 0.6076 4 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 2.1330.  MRR so far: 0.6085 4 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 2.1332.  MRR so far: 0.6082 4 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 2.1310.  MRR so far: 0.6087 4 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 2.1318.  MRR so far: 0.6087 [K  Epoch 4 (train) took 14.13s [processed 2116 samples/second]
 Training Loss: 2.129921
4 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 4 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.4910.  MRR so far: 0.1926 4 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 5.8438.  MRR so far: 0.1809 4 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.8311.  MRR so far: 0.1741 4 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.7359.  MRR so far: 0.1833 4 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 5.7956.  MRR so far: 0.1749 4 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 5.8959.  MRR so far: 0.1708 4 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 5.9099.  MRR so far: 0.1694 4 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 5.9292.  MRR so far: 0.1686 4 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 5.9396.  MRR so far: 0.1657 4 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 5.9353.  MRR so far: 0.1658 4 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 5.9365.  MRR so far: 0.1658 4 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 5.9329.  MRR so far: 0.1658 4 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 5.9045.  MRR so far: 0.1686 4 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 5.9054.  MRR so far: 0.1679 4 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 5.9069.  MRR so far: 0.1665 4 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 5.9328.  MRR so far: 0.1641 4 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 5.9415.  MRR so far: 0.1608 4 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 5.9569.  MRR so far: 0.1603 4 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 5.9919.  MRR so far: 0.1579 4 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 5.9721.  MRR so far: 0.1584 4 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 5.9854.  MRR so far: 0.1579 4 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 5.9814.  MRR so far: 0.1583 4 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 5.9669.  MRR so far: 0.1588 4 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 5.9732.  MRR so far: 0.1582 4 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.0079.  MRR so far: 0.1556 4 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.0366.  MRR so far: 0.1534 4 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.0764.  MRR so far: 0.1524 4 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.1071.  MRR so far: 0.1519 4 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.2044.  MRR so far: 0.1499 4 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.1960.  MRR so far: 0.1502 4 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.2369.  MRR so far: 0.1484 4 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.2115.  MRR so far: 0.1492 4 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.2026.  MRR so far: 0.1491 4 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.2033.  MRR so far: 0.1486 [K  Epoch 4 (valid) took 5.02s [processed 4530 samples/second]
 Validation:  Loss: 6.186687 | MRR: 0.149162
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 5 ====
5 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 5 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 1.6951.  MRR so far: 0.7007 5 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 1.6792.  MRR so far: 0.6987 5 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 1.6949.  MRR so far: 0.6939 5 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 1.6827.  MRR so far: 0.6919 5 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 1.6521.  MRR so far: 0.6972 5 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 1.6330.  MRR so far: 0.7015 5 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 1.6267.  MRR so far: 0.7023 5 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 1.6333.  MRR so far: 0.7014 5 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 1.6299.  MRR so far: 0.7021 5 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 1.6182.  MRR so far: 0.7054 5 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 1.6219.  MRR so far: 0.7042 5 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 1.6343.  MRR so far: 0.7016 5 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 1.6393.  MRR so far: 0.7006 5 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 1.6297.  MRR so far: 0.7017 5 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 1.6262.  MRR so far: 0.7027 5 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 1.6236.  MRR so far: 0.7028 5 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 1.6279.  MRR so far: 0.7016 5 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 1.6259.  MRR so far: 0.7015 5 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 1.6235.  MRR so far: 0.7019 5 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 1.6236.  MRR so far: 0.7017 5 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 1.6264.  MRR so far: 0.7012 5 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 1.6256.  MRR so far: 0.7008 5 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 1.6256.  MRR so far: 0.7011 5 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 1.6243.  MRR so far: 0.7013 5 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 1.6281.  MRR so far: 0.7005 5 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 1.6267.  MRR so far: 0.7009 5 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 1.6247.  MRR so far: 0.7014 5 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 1.6212.  MRR so far: 0.7017 5 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 1.6227.  MRR so far: 0.7013 5 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 1.6234.  MRR so far: 0.7011 5 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 1.6257.  MRR so far: 0.7012 5 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 1.6255.  MRR so far: 0.7013 5 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 1.6230.  MRR so far: 0.7017 5 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 1.6241.  MRR so far: 0.7017 5 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 1.6235.  MRR so far: 0.7021 5 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 1.6225.  MRR so far: 0.7022 5 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 1.6230.  MRR so far: 0.7024 5 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 1.6218.  MRR so far: 0.7024 5 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 1.6228.  MRR so far: 0.7022 5 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 1.6216.  MRR so far: 0.7021 5 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 1.6191.  MRR so far: 0.7024 5 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 1.6165.  MRR so far: 0.7027 5 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 1.6195.  MRR so far: 0.7019 5 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 1.6190.  MRR so far: 0.7022 5 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 1.6170.  MRR so far: 0.7024 [K  Epoch 5 (train) took 14.17s [processed 2110 samples/second]
 Training Loss: 1.618677
5 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 5 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.6768.  MRR so far: 0.2193 5 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.0134.  MRR so far: 0.2105 5 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 5.9751.  MRR so far: 0.2040 5 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 5.9415.  MRR so far: 0.2112 5 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.0052.  MRR so far: 0.2050 5 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.1239.  MRR so far: 0.1959 5 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.1226.  MRR so far: 0.1965 5 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.1494.  MRR so far: 0.1926 5 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.1788.  MRR so far: 0.1887 5 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.1661.  MRR so far: 0.1903 5 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.1640.  MRR so far: 0.1913 5 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.1656.  MRR so far: 0.1909 5 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.1279.  MRR so far: 0.1939 5 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.1425.  MRR so far: 0.1920 5 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.1414.  MRR so far: 0.1911 5 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.1763.  MRR so far: 0.1877 5 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.1884.  MRR so far: 0.1844 5 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.2076.  MRR so far: 0.1832 5 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.2486.  MRR so far: 0.1804 5 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.2281.  MRR so far: 0.1808 5 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.2419.  MRR so far: 0.1805 5 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.2382.  MRR so far: 0.1811 5 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.2212.  MRR so far: 0.1823 5 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.2354.  MRR so far: 0.1816 5 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.2753.  MRR so far: 0.1788 5 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.3143.  MRR so far: 0.1766 5 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.3595.  MRR so far: 0.1756 5 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.3937.  MRR so far: 0.1751 5 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.5148.  MRR so far: 0.1725 5 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.5030.  MRR so far: 0.1727 5 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.5530.  MRR so far: 0.1706 5 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.5191.  MRR so far: 0.1716 5 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.5068.  MRR so far: 0.1715 5 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.5045.  MRR so far: 0.1707 [K  Epoch 5 (valid) took 5.03s [processed 4526 samples/second]
 Validation:  Loss: 6.488330 | MRR: 0.171171
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 6 ====
6 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 6 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 1.2126.  MRR so far: 0.7836 6 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 1.1658.  MRR so far: 0.7945 6 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 1.1486.  MRR so far: 0.7970 6 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 1.1439.  MRR so far: 0.7967 6 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 1.1229.  MRR so far: 0.7973 6 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 1.1199.  MRR so far: 0.7974 6 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 1.1328.  MRR so far: 0.7958 6 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 1.1382.  MRR so far: 0.7945 6 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 1.1382.  MRR so far: 0.7951 6 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 1.1325.  MRR so far: 0.7964 6 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 1.1330.  MRR so far: 0.7965 6 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 1.1314.  MRR so far: 0.7969 6 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 1.1300.  MRR so far: 0.7966 6 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 1.1360.  MRR so far: 0.7959 6 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 1.1343.  MRR so far: 0.7965 6 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 1.1344.  MRR so far: 0.7957 6 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 1.1372.  MRR so far: 0.7951 6 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 1.1395.  MRR so far: 0.7943 6 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 1.1448.  MRR so far: 0.7930 6 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 1.1456.  MRR so far: 0.7925 6 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 1.1509.  MRR so far: 0.7919 6 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 1.1550.  MRR so far: 0.7908 6 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 1.1691.  MRR so far: 0.7881 6 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 1.1705.  MRR so far: 0.7876 6 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 1.1755.  MRR so far: 0.7866 6 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 1.1796.  MRR so far: 0.7858 6 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 1.1805.  MRR so far: 0.7855 6 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 1.1863.  MRR so far: 0.7845 6 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 1.1924.  MRR so far: 0.7831 6 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 1.1977.  MRR so far: 0.7823 6 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 1.1965.  MRR so far: 0.7822 6 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 1.2004.  MRR so far: 0.7816 6 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 1.2055.  MRR so far: 0.7810 6 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 1.2050.  MRR so far: 0.7814 6 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 1.2110.  MRR so far: 0.7801 6 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 1.2133.  MRR so far: 0.7798 6 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 1.2109.  MRR so far: 0.7801 6 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 1.2121.  MRR so far: 0.7798 6 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 1.2175.  MRR so far: 0.7788 6 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 1.2201.  MRR so far: 0.7780 6 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 1.2238.  MRR so far: 0.7772 6 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 1.2278.  MRR so far: 0.7766 6 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 1.2297.  MRR so far: 0.7762 6 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 1.2305.  MRR so far: 0.7762 6 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 1.2328.  MRR so far: 0.7759 [K  Epoch 6 (train) took 14.19s [processed 2106 samples/second]
 Training Loss: 1.238422
6 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 6 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.7743.  MRR so far: 0.2270 6 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.2355.  MRR so far: 0.2125 6 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.1664.  MRR so far: 0.2115 6 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.1502.  MRR so far: 0.2176 6 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.2500.  MRR so far: 0.2099 6 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.3789.  MRR so far: 0.2027 6 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.3727.  MRR so far: 0.2040 6 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.4049.  MRR so far: 0.2019 6 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.4379.  MRR so far: 0.1978 6 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.4157.  MRR so far: 0.1998 6 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.4235.  MRR so far: 0.2006 6 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.4243.  MRR so far: 0.2007 6 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.3803.  MRR so far: 0.2044 6 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.3946.  MRR so far: 0.2024 6 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.3913.  MRR so far: 0.2016 6 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.4251.  MRR so far: 0.1982 6 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.4498.  MRR so far: 0.1949 6 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.4622.  MRR so far: 0.1941 6 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.4976.  MRR so far: 0.1912 6 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.4843.  MRR so far: 0.1901 6 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.4991.  MRR so far: 0.1897 6 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.5000.  MRR so far: 0.1897 6 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.4873.  MRR so far: 0.1902 6 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.5039.  MRR so far: 0.1895 6 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.5419.  MRR so far: 0.1868 6 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.5861.  MRR so far: 0.1843 6 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.6276.  MRR so far: 0.1832 6 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.6663.  MRR so far: 0.1827 6 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 6.8151.  MRR so far: 0.1800 6 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 6.8061.  MRR so far: 0.1802 6 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 6.8792.  MRR so far: 0.1779 6 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 6.8439.  MRR so far: 0.1791 6 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 6.8306.  MRR so far: 0.1789 6 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 6.8295.  MRR so far: 0.1779 [K  Epoch 6 (valid) took 5.03s [processed 4525 samples/second]
 Validation:  Loss: 6.811928 | MRR: 0.177881
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 7 ====
7 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 7 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.9186.  MRR so far: 0.8353 7 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.8934.  MRR so far: 0.8341 7 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.9160.  MRR so far: 0.8320 7 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.9269.  MRR so far: 0.8313 7 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.9244.  MRR so far: 0.8307 7 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.9213.  MRR so far: 0.8317 7 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.9154.  MRR so far: 0.8332 7 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.9225.  MRR so far: 0.8320 7 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.9298.  MRR so far: 0.8317 7 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.9356.  MRR so far: 0.8301 7 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.9344.  MRR so far: 0.8299 7 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.9362.  MRR so far: 0.8288 7 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.9255.  MRR so far: 0.8314 7 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.9316.  MRR so far: 0.8303 7 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.9322.  MRR so far: 0.8303 7 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.9348.  MRR so far: 0.8303 7 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.9367.  MRR so far: 0.8299 7 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.9425.  MRR so far: 0.8285 7 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.9456.  MRR so far: 0.8279 7 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.9391.  MRR so far: 0.8292 7 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.9404.  MRR so far: 0.8293 7 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.9396.  MRR so far: 0.8297 7 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.9401.  MRR so far: 0.8293 7 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.9396.  MRR so far: 0.8293 7 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.9358.  MRR so far: 0.8299 7 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.9336.  MRR so far: 0.8303 7 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.9306.  MRR so far: 0.8309 7 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.9307.  MRR so far: 0.8314 7 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.9293.  MRR so far: 0.8316 7 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.9276.  MRR so far: 0.8318 7 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.9260.  MRR so far: 0.8320 7 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.9301.  MRR so far: 0.8315 7 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.9318.  MRR so far: 0.8310 7 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.9315.  MRR so far: 0.8309 7 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.9325.  MRR so far: 0.8307 7 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.9364.  MRR so far: 0.8297 7 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.9413.  MRR so far: 0.8289 7 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.9435.  MRR so far: 0.8281 7 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.9481.  MRR so far: 0.8275 7 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.9499.  MRR so far: 0.8273 7 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.9524.  MRR so far: 0.8267 7 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.9523.  MRR so far: 0.8264 7 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.9538.  MRR so far: 0.8261 7 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.9533.  MRR so far: 0.8265 7 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.9551.  MRR so far: 0.8262 [K  Epoch 7 (train) took 14.21s [processed 2104 samples/second]
 Training Loss: 0.957663
7 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 7 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 5.9523.  MRR so far: 0.2478 7 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.6158.  MRR so far: 0.2277 7 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.5323.  MRR so far: 0.2251 7 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.4758.  MRR so far: 0.2307 7 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.5590.  MRR so far: 0.2210 7 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.6849.  MRR so far: 0.2140 7 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.6520.  MRR so far: 0.2163 7 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.6731.  MRR so far: 0.2140 7 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.6955.  MRR so far: 0.2089 7 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.6676.  MRR so far: 0.2118 7 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.6568.  MRR so far: 0.2126 7 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.6609.  MRR so far: 0.2134 7 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.6110.  MRR so far: 0.2165 7 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.6308.  MRR so far: 0.2146 7 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.6377.  MRR so far: 0.2129 7 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 6.6812.  MRR so far: 0.2094 7 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 6.7126.  MRR so far: 0.2063 7 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 6.7330.  MRR so far: 0.2055 7 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 6.7707.  MRR so far: 0.2025 7 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 6.7516.  MRR so far: 0.2018 7 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 6.7678.  MRR so far: 0.2010 7 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 6.7710.  MRR so far: 0.2006 7 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 6.7630.  MRR so far: 0.2010 7 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 6.7799.  MRR so far: 0.2003 7 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 6.8312.  MRR so far: 0.1970 7 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 6.8851.  MRR so far: 0.1947 7 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 6.9287.  MRR so far: 0.1936 7 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 6.9708.  MRR so far: 0.1935 7 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 7.1376.  MRR so far: 0.1905 7 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 7.1182.  MRR so far: 0.1910 7 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 7.1953.  MRR so far: 0.1886 7 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 7.1592.  MRR so far: 0.1897 7 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 7.1497.  MRR so far: 0.1895 7 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 7.1560.  MRR so far: 0.1884 [K  Epoch 7 (valid) took 5.06s [processed 4500 samples/second]
 Validation:  Loss: 7.131209 | MRR: 0.188749
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 8 ====
8 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 8 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.7547.  MRR so far: 0.8712 8 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.7579.  MRR so far: 0.8658 8 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.7536.  MRR so far: 0.8662 8 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.7332.  MRR so far: 0.8710 8 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.7213.  MRR so far: 0.8725 8 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.7257.  MRR so far: 0.8705 8 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.7265.  MRR so far: 0.8719 8 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.7285.  MRR so far: 0.8704 8 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.7451.  MRR so far: 0.8677 8 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.7439.  MRR so far: 0.8676 8 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.7531.  MRR so far: 0.8662 8 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.7579.  MRR so far: 0.8655 8 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.7527.  MRR so far: 0.8665 8 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.7557.  MRR so far: 0.8664 8 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.7527.  MRR so far: 0.8671 8 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.7526.  MRR so far: 0.8674 8 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.7501.  MRR so far: 0.8676 8 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.7491.  MRR so far: 0.8677 8 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.7498.  MRR so far: 0.8674 8 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.7452.  MRR so far: 0.8680 8 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.7459.  MRR so far: 0.8680 8 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.7497.  MRR so far: 0.8668 8 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.7532.  MRR so far: 0.8664 8 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.7541.  MRR so far: 0.8658 8 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.7584.  MRR so far: 0.8647 8 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.7629.  MRR so far: 0.8637 8 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.7658.  MRR so far: 0.8633 8 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.7677.  MRR so far: 0.8633 8 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.7687.  MRR so far: 0.8627 8 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.7709.  MRR so far: 0.8621 8 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.7712.  MRR so far: 0.8619 8 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.7700.  MRR so far: 0.8618 8 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.7700.  MRR so far: 0.8617 8 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.7736.  MRR so far: 0.8609 8 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.7767.  MRR so far: 0.8604 8 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.7777.  MRR so far: 0.8601 8 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.7793.  MRR so far: 0.8599 8 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.7805.  MRR so far: 0.8594 8 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.7837.  MRR so far: 0.8588 8 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.7834.  MRR so far: 0.8589 8 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.7855.  MRR so far: 0.8583 8 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.7872.  MRR so far: 0.8579 8 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.7882.  MRR so far: 0.8575 8 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.7892.  MRR so far: 0.8574 8 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.7880.  MRR so far: 0.8575 [K  Epoch 8 (train) took 14.20s [processed 2105 samples/second]
 Training Loss: 0.789971
8 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 8 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.1926.  MRR so far: 0.2538 8 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 6.8485.  MRR so far: 0.2293 8 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.7687.  MRR so far: 0.2287 8 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.7832.  MRR so far: 0.2338 8 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.8588.  MRR so far: 0.2257 8 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 6.9603.  MRR so far: 0.2208 8 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 6.9593.  MRR so far: 0.2214 8 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 6.9670.  MRR so far: 0.2193 8 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 6.9934.  MRR so far: 0.2150 8 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 6.9573.  MRR so far: 0.2178 8 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 6.9660.  MRR so far: 0.2186 8 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 6.9778.  MRR so far: 0.2175 8 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 6.9324.  MRR so far: 0.2198 8 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 6.9516.  MRR so far: 0.2184 8 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 6.9648.  MRR so far: 0.2160 8 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 7.0182.  MRR so far: 0.2125 8 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 7.0549.  MRR so far: 0.2093 8 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 7.0839.  MRR so far: 0.2086 8 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 7.1309.  MRR so far: 0.2054 8 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 7.1178.  MRR so far: 0.2045 8 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 7.1379.  MRR so far: 0.2040 8 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 7.1338.  MRR so far: 0.2040 8 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 7.1293.  MRR so far: 0.2042 8 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 7.1481.  MRR so far: 0.2037 8 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 7.1980.  MRR so far: 0.2007 8 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 7.2512.  MRR so far: 0.1981 8 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 7.2822.  MRR so far: 0.1968 8 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 7.3163.  MRR so far: 0.1967 8 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 7.4830.  MRR so far: 0.1936 8 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 7.4710.  MRR so far: 0.1938 8 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 7.5600.  MRR so far: 0.1913 8 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 7.5166.  MRR so far: 0.1925 8 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 7.5013.  MRR so far: 0.1927 8 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 7.5010.  MRR so far: 0.1922 [K  Epoch 8 (valid) took 5.04s [processed 4509 samples/second]
 Validation:  Loss: 7.478824 | MRR: 0.192361
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 9 ====
9 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 9 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.6548.  MRR so far: 0.9020 9 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.6142.  MRR so far: 0.8992 9 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.6453.  MRR so far: 0.8887 9 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.6264.  MRR so far: 0.8915 9 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.6290.  MRR so far: 0.8903 9 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.6500.  MRR so far: 0.8888 9 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.6449.  MRR so far: 0.8885 9 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.6457.  MRR so far: 0.8877 9 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.6351.  MRR so far: 0.8890 9 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.6408.  MRR so far: 0.8877 9 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.6399.  MRR so far: 0.8881 9 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.6322.  MRR so far: 0.8891 9 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.6403.  MRR so far: 0.8876 9 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.6422.  MRR so far: 0.8864 9 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.6360.  MRR so far: 0.8874 9 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.6330.  MRR so far: 0.8876 9 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.6299.  MRR so far: 0.8881 9 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.6355.  MRR so far: 0.8871 9 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.6360.  MRR so far: 0.8866 9 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.6408.  MRR so far: 0.8860 9 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.6382.  MRR so far: 0.8866 9 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.6380.  MRR so far: 0.8864 9 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.6382.  MRR so far: 0.8859 9 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.6397.  MRR so far: 0.8853 9 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.6398.  MRR so far: 0.8854 9 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.6397.  MRR so far: 0.8852 9 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.6389.  MRR so far: 0.8853 9 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.6391.  MRR so far: 0.8849 9 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.6388.  MRR so far: 0.8850 9 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.6419.  MRR so far: 0.8844 9 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.6423.  MRR so far: 0.8845 9 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.6398.  MRR so far: 0.8849 9 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.6418.  MRR so far: 0.8846 9 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.6423.  MRR so far: 0.8845 9 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.6442.  MRR so far: 0.8843 9 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.6479.  MRR so far: 0.8837 9 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.6501.  MRR so far: 0.8834 9 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.6523.  MRR so far: 0.8828 9 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.6531.  MRR so far: 0.8825 9 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.6535.  MRR so far: 0.8825 9 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.6565.  MRR so far: 0.8818 9 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.6579.  MRR so far: 0.8814 9 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.6600.  MRR so far: 0.8811 9 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.6628.  MRR so far: 0.8807 9 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.6636.  MRR so far: 0.8805 [K  Epoch 9 (train) took 14.19s [processed 2106 samples/second]
 Training Loss: 0.662807
9 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 9 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.3544.  MRR so far: 0.2533 9 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 7.0035.  MRR so far: 0.2327 9 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 6.9331.  MRR so far: 0.2320 9 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 6.8718.  MRR so far: 0.2365 9 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 6.9922.  MRR so far: 0.2257 9 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 7.1248.  MRR so far: 0.2204 9 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 7.1020.  MRR so far: 0.2229 9 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 7.1180.  MRR so far: 0.2214 9 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 7.1602.  MRR so far: 0.2168 9 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 7.1005.  MRR so far: 0.2197 9 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 7.0802.  MRR so far: 0.2206 9 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 7.0835.  MRR so far: 0.2199 9 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 7.0223.  MRR so far: 0.2233 9 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 7.0484.  MRR so far: 0.2216 9 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 7.0441.  MRR so far: 0.2203 9 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 7.0936.  MRR so far: 0.2161 9 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 7.1226.  MRR so far: 0.2132 9 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 7.1540.  MRR so far: 0.2119 9 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 7.1968.  MRR so far: 0.2090 9 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 7.1845.  MRR so far: 0.2081 9 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 7.2040.  MRR so far: 0.2079 9 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 7.2011.  MRR so far: 0.2075 9 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 7.1942.  MRR so far: 0.2080 9 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 7.2177.  MRR so far: 0.2074 9 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 7.2707.  MRR so far: 0.2043 9 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 7.3251.  MRR so far: 0.2017 9 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 7.3760.  MRR so far: 0.2002 9 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 7.4160.  MRR so far: 0.2001 9 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 7.5647.  MRR so far: 0.1970 9 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 7.5489.  MRR so far: 0.1975 9 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 7.6324.  MRR so far: 0.1945 9 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 7.5928.  MRR so far: 0.1957 9 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 7.5769.  MRR so far: 0.1961 9 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 7.5824.  MRR so far: 0.1953 [K  Epoch 9 (valid) took 5.02s [processed 4529 samples/second]
 Validation:  Loss: 7.562116 | MRR: 0.195845
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 10 ====
10 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 10 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.4794.  MRR so far: 0.9172 10 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.4934.  MRR so far: 0.9173 10 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.5140.  MRR so far: 0.9113 10 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.5265.  MRR so far: 0.9089 10 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.5332.  MRR so far: 0.9085 10 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.5275.  MRR so far: 0.9092 10 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.5192.  MRR so far: 0.9108 10 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.5102.  MRR so far: 0.9128 10 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.5096.  MRR so far: 0.9132 10 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.5129.  MRR so far: 0.9120 10 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.5154.  MRR so far: 0.9114 10 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.5221.  MRR so far: 0.9105 10 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.5184.  MRR so far: 0.9106 10 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.5257.  MRR so far: 0.9097 10 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.5241.  MRR so far: 0.9099 10 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.5257.  MRR so far: 0.9100 10 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.5312.  MRR so far: 0.9096 10 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.5351.  MRR so far: 0.9082 10 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.5414.  MRR so far: 0.9072 10 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.5468.  MRR so far: 0.9060 10 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.5439.  MRR so far: 0.9062 10 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.5463.  MRR so far: 0.9056 10 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.5521.  MRR so far: 0.9037 10 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.5520.  MRR so far: 0.9035 10 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.5516.  MRR so far: 0.9036 10 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.5527.  MRR so far: 0.9032 10 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.5566.  MRR so far: 0.9023 10 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.5553.  MRR so far: 0.9025 10 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.5586.  MRR so far: 0.9016 10 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.5602.  MRR so far: 0.9013 10 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.5636.  MRR so far: 0.9007 10 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.5651.  MRR so far: 0.9001 10 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.5700.  MRR so far: 0.8990 10 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.5748.  MRR so far: 0.8981 10 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.5759.  MRR so far: 0.8980 10 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.5810.  MRR so far: 0.8968 10 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.5833.  MRR so far: 0.8964 10 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.5845.  MRR so far: 0.8962 10 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.5854.  MRR so far: 0.8959 10 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.5865.  MRR so far: 0.8958 10 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.5890.  MRR so far: 0.8952 10 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.5913.  MRR so far: 0.8947 10 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.5924.  MRR so far: 0.8943 10 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.5938.  MRR so far: 0.8939 10 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.5941.  MRR so far: 0.8936 [K  Epoch 10 (train) took 14.17s [processed 2110 samples/second]
 Training Loss: 0.596103
10 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 10 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.8546.  MRR so far: 0.2573 10 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 7.4509.  MRR so far: 0.2352 10 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 7.3257.  MRR so far: 0.2361 10 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 7.2756.  MRR so far: 0.2396 10 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 7.3790.  MRR so far: 0.2304 10 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 7.4785.  MRR so far: 0.2244 10 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 7.4480.  MRR so far: 0.2261 10 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 7.4766.  MRR so far: 0.2240 10 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 7.5225.  MRR so far: 0.2188 10 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 7.4837.  MRR so far: 0.2217 10 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 7.4664.  MRR so far: 0.2233 10 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 7.4864.  MRR so far: 0.2219 10 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 7.4192.  MRR so far: 0.2253 10 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 7.4441.  MRR so far: 0.2234 10 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 7.4305.  MRR so far: 0.2224 10 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 7.4886.  MRR so far: 0.2183 10 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 7.5366.  MRR so far: 0.2153 10 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 7.5662.  MRR so far: 0.2148 10 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 7.6051.  MRR so far: 0.2120 10 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 7.6011.  MRR so far: 0.2112 10 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 7.6175.  MRR so far: 0.2110 10 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 7.6279.  MRR so far: 0.2109 10 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 7.6266.  MRR so far: 0.2111 10 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 7.6507.  MRR so far: 0.2106 10 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 7.7076.  MRR so far: 0.2073 10 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 7.7670.  MRR so far: 0.2048 10 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 7.8181.  MRR so far: 0.2037 10 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 7.8493.  MRR so far: 0.2039 10 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 8.0408.  MRR so far: 0.2008 10 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 8.0302.  MRR so far: 0.2015 10 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 8.1255.  MRR so far: 0.1988 10 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 8.0847.  MRR so far: 0.1997 10 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 8.0653.  MRR so far: 0.2001 10 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 8.0716.  MRR so far: 0.1991 [K  Epoch 10 (valid) took 5.03s [processed 4525 samples/second]
 Validation:  Loss: 8.050986 | MRR: 0.199144
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 11 ====
11 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 11 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.4871.  MRR so far: 0.9251 11 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.5198.  MRR so far: 0.9161 11 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.5229.  MRR so far: 0.9126 11 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.5128.  MRR so far: 0.9123 11 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.5040.  MRR so far: 0.9137 11 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.5041.  MRR so far: 0.9151 11 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.4992.  MRR so far: 0.9155 11 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.4958.  MRR so far: 0.9160 11 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.4886.  MRR so far: 0.9162 11 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.4898.  MRR so far: 0.9166 11 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.4865.  MRR so far: 0.9173 11 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.4807.  MRR so far: 0.9180 11 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.4782.  MRR so far: 0.9180 11 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.4773.  MRR so far: 0.9181 11 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.4707.  MRR so far: 0.9190 11 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.4730.  MRR so far: 0.9184 11 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.4835.  MRR so far: 0.9160 11 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.4830.  MRR so far: 0.9158 11 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.4819.  MRR so far: 0.9155 11 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.4840.  MRR so far: 0.9149 11 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.4837.  MRR so far: 0.9144 11 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.4846.  MRR so far: 0.9139 11 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.4880.  MRR so far: 0.9139 11 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.4914.  MRR so far: 0.9135 11 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.4918.  MRR so far: 0.9132 11 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.4909.  MRR so far: 0.9131 11 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.4915.  MRR so far: 0.9129 11 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.4957.  MRR so far: 0.9120 11 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.4982.  MRR so far: 0.9116 11 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.4981.  MRR so far: 0.9115 11 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.4982.  MRR so far: 0.9115 11 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.4956.  MRR so far: 0.9120 11 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.4982.  MRR so far: 0.9114 11 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.5010.  MRR so far: 0.9110 11 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.5004.  MRR so far: 0.9113 11 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.5025.  MRR so far: 0.9108 11 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.5038.  MRR so far: 0.9106 11 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.5070.  MRR so far: 0.9100 11 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.5065.  MRR so far: 0.9101 11 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.5071.  MRR so far: 0.9099 11 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.5081.  MRR so far: 0.9096 11 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.5102.  MRR so far: 0.9094 11 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.5117.  MRR so far: 0.9090 11 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.5117.  MRR so far: 0.9089 11 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.5125.  MRR so far: 0.9085 [K  Epoch 11 (train) took 14.13s [processed 2115 samples/second]
 Training Loss: 0.512757
11 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 11 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.9481.  MRR so far: 0.2634 11 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 7.5395.  MRR so far: 0.2385 11 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 7.4480.  MRR so far: 0.2379 11 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 7.3128.  MRR so far: 0.2452 11 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 7.4420.  MRR so far: 0.2377 11 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 7.6007.  MRR so far: 0.2309 11 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 7.5863.  MRR so far: 0.2341 11 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 7.5615.  MRR so far: 0.2317 11 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 7.6254.  MRR so far: 0.2267 11 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 7.5888.  MRR so far: 0.2291 11 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 7.5591.  MRR so far: 0.2307 11 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 7.5584.  MRR so far: 0.2296 11 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 7.5106.  MRR so far: 0.2323 11 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 7.5389.  MRR so far: 0.2291 11 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 7.5233.  MRR so far: 0.2284 11 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 7.5781.  MRR so far: 0.2248 11 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 7.6278.  MRR so far: 0.2217 11 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 7.6604.  MRR so far: 0.2201 11 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 7.6985.  MRR so far: 0.2164 11 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 7.6775.  MRR so far: 0.2154 11 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 7.7070.  MRR so far: 0.2152 11 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 7.7219.  MRR so far: 0.2152 11 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 7.7160.  MRR so far: 0.2157 11 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 7.7391.  MRR so far: 0.2152 11 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 7.7889.  MRR so far: 0.2123 11 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 7.8578.  MRR so far: 0.2095 11 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 7.9131.  MRR so far: 0.2081 11 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 7.9569.  MRR so far: 0.2079 11 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 8.1303.  MRR so far: 0.2047 11 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 8.1249.  MRR so far: 0.2049 11 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 8.2341.  MRR so far: 0.2024 11 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 8.1959.  MRR so far: 0.2033 11 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 8.1795.  MRR so far: 0.2037 11 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 8.1863.  MRR so far: 0.2027 [K  Epoch 11 (valid) took 5.02s [processed 4530 samples/second]
 Validation:  Loss: 8.162717 | MRR: 0.203340
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 12 ====
12 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 12 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.3818.  MRR so far: 0.9342 12 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.4314.  MRR so far: 0.9281 12 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.4142.  MRR so far: 0.9278 12 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.4024.  MRR so far: 0.9303 12 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.3951.  MRR so far: 0.9320 12 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.3921.  MRR so far: 0.9329 12 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.3972.  MRR so far: 0.9309 12 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.4092.  MRR so far: 0.9269 12 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.4174.  MRR so far: 0.9253 12 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.4173.  MRR so far: 0.9262 12 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.4246.  MRR so far: 0.9259 12 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.4214.  MRR so far: 0.9258 12 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.4173.  MRR so far: 0.9265 12 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.4206.  MRR so far: 0.9259 12 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.4269.  MRR so far: 0.9253 12 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.4278.  MRR so far: 0.9249 12 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.4291.  MRR so far: 0.9247 12 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.4300.  MRR so far: 0.9243 12 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.4266.  MRR so far: 0.9248 12 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.4314.  MRR so far: 0.9239 12 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.4328.  MRR so far: 0.9233 12 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.4359.  MRR so far: 0.9223 12 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.4360.  MRR so far: 0.9217 12 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.4377.  MRR so far: 0.9217 12 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.4418.  MRR so far: 0.9211 12 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.4442.  MRR so far: 0.9207 12 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.4449.  MRR so far: 0.9204 12 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.4491.  MRR so far: 0.9197 12 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.4514.  MRR so far: 0.9193 12 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.4547.  MRR so far: 0.9188 12 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.4559.  MRR so far: 0.9187 12 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.4549.  MRR so far: 0.9189 12 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.4535.  MRR so far: 0.9190 12 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.4540.  MRR so far: 0.9187 12 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.4570.  MRR so far: 0.9180 12 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.4579.  MRR so far: 0.9177 12 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.4609.  MRR so far: 0.9172 12 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.4642.  MRR so far: 0.9166 12 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.4656.  MRR so far: 0.9164 12 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.4661.  MRR so far: 0.9164 12 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.4682.  MRR so far: 0.9159 12 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.4685.  MRR so far: 0.9159 12 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.4685.  MRR so far: 0.9159 12 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.4684.  MRR so far: 0.9160 12 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.4674.  MRR so far: 0.9160 [K  Epoch 12 (train) took 14.12s [processed 2117 samples/second]
 Training Loss: 0.467638
12 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 12 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.4737.  MRR so far: 0.2724 12 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 7.4653.  MRR so far: 0.2466 12 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 7.3445.  MRR so far: 0.2422 12 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 7.2156.  MRR so far: 0.2465 12 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 7.3170.  MRR so far: 0.2362 12 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 7.4160.  MRR so far: 0.2312 12 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 7.4172.  MRR so far: 0.2321 12 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 7.4061.  MRR so far: 0.2299 12 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 7.4586.  MRR so far: 0.2256 12 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 7.4125.  MRR so far: 0.2291 12 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 7.3756.  MRR so far: 0.2314 12 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 7.3861.  MRR so far: 0.2305 12 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 7.3211.  MRR so far: 0.2333 12 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 7.3326.  MRR so far: 0.2310 12 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 7.3226.  MRR so far: 0.2296 12 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 7.3825.  MRR so far: 0.2256 12 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 7.4268.  MRR so far: 0.2230 12 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 7.4477.  MRR so far: 0.2225 12 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 7.4837.  MRR so far: 0.2195 12 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 7.4676.  MRR so far: 0.2189 12 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 7.4840.  MRR so far: 0.2186 12 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 7.4976.  MRR so far: 0.2182 12 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 7.4909.  MRR so far: 0.2189 12 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 7.5158.  MRR so far: 0.2185 12 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 7.5828.  MRR so far: 0.2154 12 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 7.6475.  MRR so far: 0.2128 12 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 7.6964.  MRR so far: 0.2115 12 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 7.7214.  MRR so far: 0.2117 12 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 7.8696.  MRR so far: 0.2086 12 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 7.8541.  MRR so far: 0.2091 12 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 7.9444.  MRR so far: 0.2062 12 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 7.9045.  MRR so far: 0.2077 12 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 7.8900.  MRR so far: 0.2081 12 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 7.8949.  MRR so far: 0.2073 [K  Epoch 12 (valid) took 5.02s [processed 4533 samples/second]
 Validation:  Loss: 7.876579 | MRR: 0.207646
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 13 ====
13 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 13 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.3483.  MRR so far: 0.9444 13 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.3639.  MRR so far: 0.9394 13 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.3713.  MRR so far: 0.9365 13 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.3707.  MRR so far: 0.9383 13 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.3599.  MRR so far: 0.9381 13 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.3625.  MRR so far: 0.9356 13 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.3650.  MRR so far: 0.9350 13 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.3755.  MRR so far: 0.9335 13 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.3872.  MRR so far: 0.9313 13 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.3848.  MRR so far: 0.9315 13 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.3827.  MRR so far: 0.9319 13 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.3895.  MRR so far: 0.9311 13 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.3870.  MRR so far: 0.9316 13 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.3894.  MRR so far: 0.9314 13 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.3878.  MRR so far: 0.9314 13 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.3831.  MRR so far: 0.9323 13 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.3851.  MRR so far: 0.9322 13 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.3859.  MRR so far: 0.9323 13 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.3881.  MRR so far: 0.9317 13 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.3864.  MRR so far: 0.9321 13 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.3883.  MRR so far: 0.9318 13 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.3877.  MRR so far: 0.9320 13 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.3910.  MRR so far: 0.9313 13 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.3936.  MRR so far: 0.9307 13 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.3973.  MRR so far: 0.9301 13 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.3992.  MRR so far: 0.9298 13 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.3985.  MRR so far: 0.9296 13 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.4003.  MRR so far: 0.9292 13 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.4053.  MRR so far: 0.9283 13 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.4060.  MRR so far: 0.9283 13 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.4092.  MRR so far: 0.9278 13 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.4091.  MRR so far: 0.9279 13 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.4097.  MRR so far: 0.9276 13 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.4125.  MRR so far: 0.9269 13 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.4117.  MRR so far: 0.9272 13 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.4141.  MRR so far: 0.9266 13 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.4134.  MRR so far: 0.9266 13 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.4130.  MRR so far: 0.9267 13 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.4152.  MRR so far: 0.9263 13 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.4171.  MRR so far: 0.9259 13 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.4172.  MRR so far: 0.9259 13 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.4203.  MRR so far: 0.9254 13 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.4205.  MRR so far: 0.9252 13 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.4223.  MRR so far: 0.9248 13 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.4232.  MRR so far: 0.9247 [K  Epoch 13 (train) took 14.15s [processed 2113 samples/second]
 Training Loss: 0.423011
13 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 13 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.7461.  MRR so far: 0.2795 13 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 7.8556.  MRR so far: 0.2510 13 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 7.5955.  MRR so far: 0.2524 13 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 7.4823.  MRR so far: 0.2590 13 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 7.6107.  MRR so far: 0.2487 13 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 7.7330.  MRR so far: 0.2442 13 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 7.7294.  MRR so far: 0.2445 13 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 7.7515.  MRR so far: 0.2411 13 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 7.8174.  MRR so far: 0.2340 13 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 7.7610.  MRR so far: 0.2355 13 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 7.7170.  MRR so far: 0.2382 13 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 7.7131.  MRR so far: 0.2384 13 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 7.6365.  MRR so far: 0.2416 13 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 7.6617.  MRR so far: 0.2383 13 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 7.6508.  MRR so far: 0.2364 13 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 7.7224.  MRR so far: 0.2319 13 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 7.7880.  MRR so far: 0.2285 13 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 7.8037.  MRR so far: 0.2271 13 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 7.8301.  MRR so far: 0.2235 13 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 7.8137.  MRR so far: 0.2225 13 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 7.8342.  MRR so far: 0.2221 13 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 7.8332.  MRR so far: 0.2220 13 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 7.8264.  MRR so far: 0.2221 13 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 7.8509.  MRR so far: 0.2213 13 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 7.9043.  MRR so far: 0.2184 13 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 7.9607.  MRR so far: 0.2158 13 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 8.0077.  MRR so far: 0.2145 13 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 8.0303.  MRR so far: 0.2142 13 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 8.1680.  MRR so far: 0.2107 13 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 8.1437.  MRR so far: 0.2116 13 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 8.2506.  MRR so far: 0.2086 13 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 8.2145.  MRR so far: 0.2092 13 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 8.2039.  MRR so far: 0.2094 13 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 8.1990.  MRR so far: 0.2085 [K  Epoch 13 (valid) took 5.00s [processed 4548 samples/second]
 Validation:  Loss: 8.180616 | MRR: 0.208647
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
==== Epoch 14 ====
14 (train): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 14 (train): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 0.3546.  MRR so far: 0.9384 14 (train): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 0.3414.  MRR so far: 0.9397 14 (train): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 0.3628.  MRR so far: 0.9372 14 (train): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 0.3565.  MRR so far: 0.9384 14 (train): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 0.3580.  MRR so far: 0.9368 14 (train): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 0.3578.  MRR so far: 0.9374 14 (train): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 0.3588.  MRR so far: 0.9366 14 (train): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 0.3596.  MRR so far: 0.9361 14 (train): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 0.3621.  MRR so far: 0.9359 14 (train): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 0.3634.  MRR so far: 0.9362 14 (train): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 0.3647.  MRR so far: 0.9361 14 (train): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 0.3627.  MRR so far: 0.9362 14 (train): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 0.3579.  MRR so far: 0.9368 14 (train): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 0.3592.  MRR so far: 0.9368 14 (train): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 0.3600.  MRR so far: 0.9361 14 (train): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 0.3673.  MRR so far: 0.9352 14 (train): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 0.3685.  MRR so far: 0.9347 14 (train): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 0.3666.  MRR so far: 0.9347 14 (train): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 0.3692.  MRR so far: 0.9340 14 (train): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 0.3698.  MRR so far: 0.9340 14 (train): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 0.3711.  MRR so far: 0.9338 14 (train): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 0.3686.  MRR so far: 0.9341 14 (train): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 0.3686.  MRR so far: 0.9343 14 (train): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 0.3705.  MRR so far: 0.9343 14 (train): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 0.3723.  MRR so far: 0.9337 14 (train): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 0.3733.  MRR so far: 0.9335 14 (train): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 0.3765.  MRR so far: 0.9329 14 (train): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 0.3803.  MRR so far: 0.9325 14 (train): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 0.3789.  MRR so far: 0.9324 14 (train): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 0.3778.  MRR so far: 0.9327 14 (train): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 0.3778.  MRR so far: 0.9326 14 (train): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 0.3790.  MRR so far: 0.9326 14 (train): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 0.3815.  MRR so far: 0.9320 14 (train): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 0.3828.  MRR so far: 0.9316 14 (train): Batch    35 (has 650 samples). Processed 22750 samples. Loss so far: 0.3830.  MRR so far: 0.9315 14 (train): Batch    36 (has 650 samples). Processed 23400 samples. Loss so far: 0.3847.  MRR so far: 0.9309 14 (train): Batch    37 (has 650 samples). Processed 24050 samples. Loss so far: 0.3840.  MRR so far: 0.9310 14 (train): Batch    38 (has 650 samples). Processed 24700 samples. Loss so far: 0.3855.  MRR so far: 0.9307 14 (train): Batch    39 (has 650 samples). Processed 25350 samples. Loss so far: 0.3848.  MRR so far: 0.9310 14 (train): Batch    40 (has 650 samples). Processed 26000 samples. Loss so far: 0.3859.  MRR so far: 0.9309 14 (train): Batch    41 (has 650 samples). Processed 26650 samples. Loss so far: 0.3852.  MRR so far: 0.9309 14 (train): Batch    42 (has 650 samples). Processed 27300 samples. Loss so far: 0.3851.  MRR so far: 0.9309 14 (train): Batch    43 (has 650 samples). Processed 27950 samples. Loss so far: 0.3875.  MRR so far: 0.9306 14 (train): Batch    44 (has 650 samples). Processed 28600 samples. Loss so far: 0.3871.  MRR so far: 0.9306 14 (train): Batch    45 (has 650 samples). Processed 29250 samples. Loss so far: 0.3879.  MRR so far: 0.9304 [K  Epoch 14 (train) took 14.10s [processed 2121 samples/second]
 Training Loss: 0.387619
14 (valid): Batch     0 (has 650 samples). Processed 0 samples. Loss so far: 0.0000.  MRR so far: 0.0000 14 (valid): Batch     1 (has 650 samples). Processed 650 samples. Loss so far: 6.9179.  MRR so far: 0.2843 14 (valid): Batch     2 (has 650 samples). Processed 1300 samples. Loss so far: 8.1438.  MRR so far: 0.2558 14 (valid): Batch     3 (has 650 samples). Processed 1950 samples. Loss so far: 7.9389.  MRR so far: 0.2541 14 (valid): Batch     4 (has 650 samples). Processed 2600 samples. Loss so far: 7.7966.  MRR so far: 0.2570 14 (valid): Batch     5 (has 650 samples). Processed 3250 samples. Loss so far: 7.8977.  MRR so far: 0.2483 14 (valid): Batch     6 (has 650 samples). Processed 3900 samples. Loss so far: 8.0196.  MRR so far: 0.2424 14 (valid): Batch     7 (has 650 samples). Processed 4550 samples. Loss so far: 7.9840.  MRR so far: 0.2439 14 (valid): Batch     8 (has 650 samples). Processed 5200 samples. Loss so far: 8.0039.  MRR so far: 0.2395 14 (valid): Batch     9 (has 650 samples). Processed 5850 samples. Loss so far: 8.0532.  MRR so far: 0.2337 14 (valid): Batch    10 (has 650 samples). Processed 6500 samples. Loss so far: 7.9672.  MRR so far: 0.2376 14 (valid): Batch    11 (has 650 samples). Processed 7150 samples. Loss so far: 7.9420.  MRR so far: 0.2385 14 (valid): Batch    12 (has 650 samples). Processed 7800 samples. Loss so far: 7.9288.  MRR so far: 0.2385 14 (valid): Batch    13 (has 650 samples). Processed 8450 samples. Loss so far: 7.8713.  MRR so far: 0.2415 14 (valid): Batch    14 (has 650 samples). Processed 9100 samples. Loss so far: 7.8873.  MRR so far: 0.2388 14 (valid): Batch    15 (has 650 samples). Processed 9750 samples. Loss so far: 7.8742.  MRR so far: 0.2378 14 (valid): Batch    16 (has 650 samples). Processed 10400 samples. Loss so far: 7.9488.  MRR so far: 0.2332 14 (valid): Batch    17 (has 650 samples). Processed 11050 samples. Loss so far: 8.0106.  MRR so far: 0.2303 14 (valid): Batch    18 (has 650 samples). Processed 11700 samples. Loss so far: 8.0312.  MRR so far: 0.2297 14 (valid): Batch    19 (has 650 samples). Processed 12350 samples. Loss so far: 8.0671.  MRR so far: 0.2262 14 (valid): Batch    20 (has 650 samples). Processed 13000 samples. Loss so far: 8.0383.  MRR so far: 0.2258 14 (valid): Batch    21 (has 650 samples). Processed 13650 samples. Loss so far: 8.0543.  MRR so far: 0.2259 14 (valid): Batch    22 (has 650 samples). Processed 14300 samples. Loss so far: 8.0620.  MRR so far: 0.2255 14 (valid): Batch    23 (has 650 samples). Processed 14950 samples. Loss so far: 8.0523.  MRR so far: 0.2264 14 (valid): Batch    24 (has 650 samples). Processed 15600 samples. Loss so far: 8.0733.  MRR so far: 0.2262 14 (valid): Batch    25 (has 650 samples). Processed 16250 samples. Loss so far: 8.1316.  MRR so far: 0.2231 14 (valid): Batch    26 (has 650 samples). Processed 16900 samples. Loss so far: 8.1922.  MRR so far: 0.2205 14 (valid): Batch    27 (has 650 samples). Processed 17550 samples. Loss so far: 8.2324.  MRR so far: 0.2195 14 (valid): Batch    28 (has 650 samples). Processed 18200 samples. Loss so far: 8.2536.  MRR so far: 0.2193 14 (valid): Batch    29 (has 650 samples). Processed 18850 samples. Loss so far: 8.3940.  MRR so far: 0.2165 14 (valid): Batch    30 (has 650 samples). Processed 19500 samples. Loss so far: 8.3853.  MRR so far: 0.2173 14 (valid): Batch    31 (has 650 samples). Processed 20150 samples. Loss so far: 8.5206.  MRR so far: 0.2139 14 (valid): Batch    32 (has 650 samples). Processed 20800 samples. Loss so far: 8.4902.  MRR so far: 0.2149 14 (valid): Batch    33 (has 650 samples). Processed 21450 samples. Loss so far: 8.4807.  MRR so far: 0.2152 14 (valid): Batch    34 (has 650 samples). Processed 22100 samples. Loss so far: 8.4807.  MRR so far: 0.2141 [K  Epoch 14 (valid) took 4.99s [processed 4554 samples/second]
 Validation:  Loss: 8.466924 | MRR: 0.213952
  Best result so far -- saved model as '/trained_models/convselfatt-2019-10-18-21-43-42_model_best.pkl.gz'.
2019-10-18 21:51:45.236617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2019-10-18 21:51:45.236683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-10-18 21:51:45.236695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2019-10-18 21:51:45.236702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2019-10-18 21:51:45.236781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14943 MB memory) -> physical GPU (device: 0, name: Tesla V100-PCIE-16GB, pci bus id: 0000:00:07.0, compute capability: 7.0)
Test-All MRR (bs=1,000):  0.222
FuncNameTest-All MRR (bs=1,000):  0.217
Validation-All MRR (bs=1,000):  0.192
Test-python MRR (bs=1,000):  0.222
FuncNameTest-python MRR (bs=1,000):  0.217
Validation-python MRR (bs=1,000):  0.192
